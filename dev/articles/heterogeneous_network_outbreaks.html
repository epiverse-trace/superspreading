<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Outbreaks in heterogeneous networks • superspreading</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Outbreaks in heterogeneous networks">
<meta name="robots" content="noindex">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/superspreading.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6></li>
    <li><a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Proportion transmission</h6></li>
    <li><a class="dropdown-item" href="../articles/proportion_transmission.html">Methods for calculating the proportion of transmission</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Pathogen evolution and emergence</h6></li>
    <li><a class="dropdown-item" href="../articles/emergence.html">Pathogen evolution in the emergence of infectious disease outbreaks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Outbreaks in heterogeneous networks</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/main/vignettes/heterogeneous_network_outbreaks.Rmd" class="external-link"><code>vignettes/heterogeneous_network_outbreaks.Rmd</code></a></small>
      <div class="d-none name"><code>heterogeneous_network_outbreaks.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<p>Determining if an outbreak will grow and spread through a susceptible
population is quantified by the basic reproduction number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>).
When there is individual-level variability in the connectedness of
different individuals in a network (i.e. higher variance in the degree
of each node) it can lead to heterogeneity in transmission dynamics.
Such scenarios are common in persistent sexually transmitted infections
(STIs), where partners can change during the infectious period, which
means highly connected individuals can be both more likely to acquire
and pass on the infection.</p>
<p>Under the basic assumption of homogeneous contact patterns (i.e. no
network effects), we have the following expression for the basic
reproduction number:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mfrac><mrow><mi>β</mi><mi>M</mi></mrow><mi>γ</mi></mfrac></mrow><annotation encoding="application/x-tex">
R_0 = \frac{\beta M}{\gamma}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is the probability of transmission per contact,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mi>γ</mi></mrow><annotation encoding="application/x-tex">1/\gamma</annotation></semantics></math>
is the duration of infectiousness
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
is the rate of loss of infectiousness) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
is the mean number of contacts (or partners) per unit time (e.g., per
year).</p>
<p>In contrast, <span class="citation">May and Anderson (<a href="#ref-mayTransmissionDynamicsHuman1988">1988</a>)</span> showed
that the transmissibility of an infectious disease in a heterogeneous
network can be defined as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mfrac><mi>β</mi><mi>γ</mi></mfrac><mfrac><mrow><msup><mi>M</mi><mn>2</mn></msup><mo>+</mo><mi>V</mi></mrow><mi>M</mi></mfrac></mrow><annotation encoding="application/x-tex">
R_0 = \frac{\beta}{\gamma} \frac{M^2 + V}{M}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math>
is the variance of the number of contacts per unit time. This
formulation can be appropriate if heterogeneity is predictable over time
(i.e. highly connected individuals typically remain highly connected),
the duration of infectiousness is similar or longer to the frequency of
partner change among highly connected individuals, and the disease has
the potential to cause a substantial outbreak (i.e. larger value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
and/or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mi>γ</mi></mrow><annotation encoding="application/x-tex">1/\gamma</annotation></semantics></math>).</p>
<p>The {superspreading} package provides the
<code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> function to calculate the reproduction
number using the unadjusted formula (first equation) and the adjusted
formula (second equation).</p>
<p>For example, the possibility of a sexually transmitted Zika virus
outbreak was a particular concern when the infection spread globally in
2015-16. <span class="citation">Yakob et al. (<a href="#ref-yakobLowRiskSexuallytransmitted2016">2016</a>)</span> used
the above heterogeneous network model to determine the risk that sexual
transmission could be a common mode of transmission for Zika virus,
leading to sustained human-to-human transmission in the absence of
vectors.</p>
<p>Here we replicate the analysis of <span class="citation">Yakob et al.
(<a href="#ref-yakobLowRiskSexuallytransmitted2016">2016</a>)</span> to
show the low likelihood of Zika causing an outbreak from sexual
transmission. Following <span class="citation">Yakob et al. (<a href="#ref-yakobLowRiskSexuallytransmitted2016">2016</a>)</span>, we use
data from the National Survey of Sexual Attitude and Lifestyles (Natsal)
on the mean and variance in the number of sexual partners and age range
<span class="citation">(<a href="#ref-mercerChangesSexualAttitudes2013">Mercer et al.
2013</a>)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infect_duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prob_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  infect_duration <span class="op">=</span> <span class="va">infect_duration</span>,</span>
<span>  prob_transmission <span class="op">=</span> <span class="va">prob_transmission</span></span>
<span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>  <span class="va">params</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/calc_network_R.html">calc_network_R</a></span><span class="op">(</span></span>
<span>      mean_num_contact <span class="op">=</span> <span class="fl">14.1</span>,</span>
<span>      sd_num_contact <span class="op">=</span> <span class="fl">69.6</span>,</span>
<span>      infect_duration <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"infect_duration"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      prob_transmission <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"prob_transmission"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      age_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">74</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">params</span>, <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">res</span>,</span>
<span>  varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  v.names <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">infect_duration</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_transmission</span>,</span>
<span>      fill <span class="op">=</span> <span class="va">R</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">infect_duration</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_transmission</span>,</span>
<span>      z <span class="op">=</span> <span class="va">R</span></span>
<span>    <span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fl">1</span>,  <span class="co"># Set the contour line at R = 1</span></span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Mean duration of infectiousness"</span>,</span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Zika virus transmission probability per sexual partners"</span>,</span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span>,</span>
<span>    labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link">as_labeller</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>R <span class="op">=</span> <span class="st">"R"</span>, R_net <span class="op">=</span> <span class="st">"Adjusted R"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span></span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">R</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">R</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="heterogeneous_network_outbreaks_files/figure-html/plot-zika-r-1.png" alt="The reproduction number using the unadjusted and adjusted calculation -- calculated using `calc_network_R()` -- with mean duration of infection on the x-axis and transmission probability per sexual partner on the y-axis. The line shows the points that $R_0$ is equal to one. Both axes are plotted on a natural log scale. This plot is similar to Figure 1 from @yakobLowRiskSexuallytransmitted2016, but is plotted as a heatmap and without annotation." width="768"><p class="caption">
The reproduction number using the unadjusted and adjusted calculation –
calculated using <code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> – with mean duration of
infection on the x-axis and transmission probability per sexual partner
on the y-axis. The line shows the points that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
is equal to one. Both axes are plotted on a natural log scale. This plot
is similar to Figure 1 from <span class="citation">Yakob et al. (<a href="#ref-yakobLowRiskSexuallytransmitted2016">2016</a>)</span>, but is
plotted as a heatmap and without annotation.
</p>
</div>
<p>Another study that showed the network effects on transmission of an
STI was <span class="citation">Endo et al. (<a href="#ref-endoHeavytailedSexualContact2022">2022</a>)</span>, who
estimated that Mpox (or monkeypox) could spread throughout a network on
men who have sex with men (MSM), but would have lower transmissibility
in the wider population. Using the Natsal UK data <span class="citation">(<a href="#ref-mercerChangesSexualAttitudes2013">Mercer
et al. 2013</a>)</span> on same- and opposite-sex sexual partnerships
for the age range of 18 to 44, they show that the disease transmission
for MSM is greater than for a non-MSM transmission network. Because Mpox
has a relatively short infectious period, this study assumed that
contacts remained fixed during the period of infection, and hence used a
next generation matrix approach more akin to the group-specific
transmission defined in the <a href="https://epiverse-trace.github.io/finalsize/" class="external-link">finalsize
package</a>.</p>
<p>For comparison, we produce a figure similar to <span class="citation">Endo et al. (<a href="#ref-endoHeavytailedSexualContact2022">2022</a>)</span>, using
<code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> instead to show how highly connected
individuals – who are more likely to acquire and pass on infection –
alter the estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
compared to the simpler assumption of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mi>S</mi><mi>A</mi><mi>R</mi><mo>×</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">R_0 = SAR \times contacts</annotation></semantics></math>,
under the assumptions described above.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">duration_years</span> <span class="op">&lt;-</span> <span class="fl">21</span> <span class="op">/</span> <span class="fl">365</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="va">beta</span>,</span>
<span>  <span class="va">calc_network_R</span>,</span>
<span>  mean_num_contact <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  sd_num_contact <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  infect_duration <span class="op">=</span> <span class="va">duration_years</span>,</span>
<span>  age_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">44</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">res</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">beta</span>, <span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">res</span>,</span>
<span>  varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  v.names <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">beta</span>, y <span class="op">=</span> <span class="va">R</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Reproduction Number (R)"</span>,</span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Secondary Attack Rate (SAR)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Reproduction Number"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"Adjusted R"</span><span class="op">)</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="heterogeneous_network_outbreaks_files/figure-html/plot-mpox-1.png" alt="The reproduction number using the unadjusted and adjusted calculation -- calculated using `calc_network_R()` -- with secondary attack rate on the x-axis and reproduction number ($R_0$) on the y-axis. This plot is similar to Figure 2A from @endoHeavytailedSexualContact2022." width="768"><p class="caption">
The reproduction number using the unadjusted and adjusted calculation –
calculated using <code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> – with secondary attack
rate on the x-axis and reproduction number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>)
on the y-axis. This plot is similar to Figure 2A from <span class="citation">Endo et al. (<a href="#ref-endoHeavytailedSexualContact2022">2022</a>)</span>.
</p>
</div>
<div class="alert alert-warning">
<p><em>Methodological caveat</em>: There is a link with the theory for
the main negative binomial models from the <a href="https://epiverse-trace.github.io/superspreading/">superspreading
package</a> here (which have a Gamma distributed mean), because the
above Anderson and May formulation requires the ‘true’ mean and variance
of the underlying static contact distribution, rather than the observed
mean and variance. To give the superspreading version: in a simple
branching process with fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
(i.e. zero variance in the individual-level reproduction number, perhaps
because everyone has an identical number of contacts), the Poisson
distributed number of transmissions per year measured exhibits more
variation than the ‘true’
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
(which has zero variance). For the above STI model, taking the lifetime
average deals with this problem some extent, because if we look at the
sum of contacts over a large number of years, then calculate the mean
per year, the observed distribution will converge as the number of years
gets very large.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-endoHeavytailedSexualContact2022" class="csl-entry">
Endo, Akira, Hiroaki Murayama, Sam Abbott, Ruwan Ratnayake, Carl A. B.
Pearson, W. John Edmunds, Elizabeth Fearon, and Sebastian Funk. 2022.
<span>“Heavy-Tailed Sexual Contact Networks and Monkeypox Epidemiology
in the Global Outbreak, 2022.”</span> <em>Science</em> 378 (6615):
90–94. <a href="https://doi.org/10.1126/science.add4507" class="external-link">https://doi.org/10.1126/science.add4507</a>.
</div>
<div id="ref-mayTransmissionDynamicsHuman1988" class="csl-entry">
May, Robert, and Roy Anderson. 1988. <span>“The Transmission Dynamics of
Human Immunodeficiency Virus (HIV).”</span> <em>Philosophical
Transactions of the Royal Society of London. B, Biological Sciences</em>
321 (1207): 565–607. <a href="https://doi.org/10.1098/rstb.1988.0108" class="external-link">https://doi.org/10.1098/rstb.1988.0108</a>.
</div>
<div id="ref-mercerChangesSexualAttitudes2013" class="csl-entry">
Mercer, Catherine H, Clare Tanton, Philip Prah, Bob Erens, Pam
Sonnenberg, Soazig Clifton, Wendy Macdowall, et al. 2013. <span>“Changes
in Sexual Attitudes and Lifestyles in Britain Through the Life Course
and over Time: Findings from the National Surveys of Sexual Attitudes
and Lifestyles (Natsal).”</span> <em>The Lancet</em> 382 (9907):
1781–94. <a href="https://doi.org/10.1016/S0140-6736(13)62035-8" class="external-link">https://doi.org/10.1016/S0140-6736(13)62035-8</a>.
</div>
<div id="ref-yakobLowRiskSexuallytransmitted2016" class="csl-entry">
Yakob, Laith, Adam Kucharski, Stephane Hue, and W John Edmunds. 2016.
<span>“Low Risk of a Sexually-Transmitted Zika Virus Outbreak.”</span>
<em>The Lancet Infectious Diseases</em> 16 (10): 1100–1102. <a href="https://doi.org/10.1016/S1473-3099(16)30324-3" class="external-link">https://doi.org/10.1016/S1473-3099(16)30324-3</a>.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Dillon C. Adam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
