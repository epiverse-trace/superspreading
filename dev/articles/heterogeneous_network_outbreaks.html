<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="superspreading">
<title>Outbreaks in heterogeneous networks • superspreading</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Outbreaks in heterogeneous networks">
<meta property="og:description" content="superspreading">
<meta property="og:image" content="https://epiverse-trace.github.io/superspreading/logo.svg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-danger me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/superspreading.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6>
    <a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a>
    <a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6>
    <a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6>
    <a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Outbreaks in heterogeneous networks</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/HEAD/vignettes/heterogeneous_network_outbreaks.Rmd" class="external-link"><code>vignettes/heterogeneous_network_outbreaks.Rmd</code></a></small>
      <div class="d-none name"><code>heterogeneous_network_outbreaks.Rmd</code></div>
    </div>

    
    
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
</details><p>Determining if an outbreak will grow and spread through a susceptible population is quantified by the basic reproduction number (<span class="math inline">\(R_0\)</span>). When there is individual-level variability in the connectedness of different individuals in a network (i.e. higher variance in the degree of each node) it can lead to heterogeneity in transmission dynamics. Such scenarios are common in persistent sexually transmitted infections (STIs), where partners can change during the infectious period, which means highly connected individuals can be both more likely to acquire and pass on the infection.</p>
<p>Under the basic assumption of homogeneous contact patterns (i.e. no network effects), we have the following expression for the basic reproduction number:</p>
<p><span class="math display">\[
R_0 = \frac{\beta M}{\gamma}
\]</span>
where <span class="math inline">\(\beta\)</span> is the probability of transmission per contact, <span class="math inline">\(1/\gamma\)</span> is the duration of infectiousness (<span class="math inline">\(\gamma\)</span> is the rate of loss of infectiousness) and <span class="math inline">\(M\)</span> is the mean number of contacts (or partners) per unit time (e.g., per year).</p>
<p>In contrast, <span class="citation">May and Anderson (<a href="#ref-mayTransmissionDynamicsHuman1988" role="doc-biblioref">1988</a>)</span> showed that the transmissibility of an infectious disease in a heterogeneous network can be defined as follows:</p>
<p><span class="math display">\[
R_0 = \frac{\beta}{\gamma} \frac{M^2 + V}{M}
\]</span>
where <span class="math inline">\(V\)</span> is the variance of the number of contacts per unit time. This formulation can be appropriate if heterogeneity is predictable over time (i.e. highly connected individuals typically remain highly connected), the duration of infectiousness is similar or longer to the frequency of partner change among highly connected individuals, and the disease has the potential to cause a substantial outbreak (i.e. larger value of <span class="math inline">\(\beta\)</span> and/or <span class="math inline">\(1/\gamma\)</span>).</p>
<p>The {superspreading} package provides the <code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> function to calculate the reproduction number using the unadjusted formula (first equation) and the adjusted formula (second equation).</p>
<p>For example, the possibility of a sexually transmitted Zika virus outbreak was a particular concern when the infection spread globally in 2015-16. <span class="citation">Yakob et al. (<a href="#ref-yakobLowRiskSexuallytransmitted2016" role="doc-biblioref">2016</a>)</span> used the above heterogeneous network model to determine the risk that sexual transmission could be a common mode of transmission for Zika virus, leading to sustained human-to-human transmission in the absence of vectors.</p>
<p>Here we replicate the analysis of <span class="citation">Yakob et al. (<a href="#ref-yakobLowRiskSexuallytransmitted2016" role="doc-biblioref">2016</a>)</span> to show the low likelihood of Zika causing an outbreak from sexual transmission. Following <span class="citation">Yakob et al. (<a href="#ref-yakobLowRiskSexuallytransmitted2016" role="doc-biblioref">2016</a>)</span>, we use data from the National Survey of Sexual Attitude and Lifestyles (Natsal) on the mean and variance in the number of sexual partners and age range <span class="citation">(<a href="#ref-mercerChangesSexualAttitudes2013" role="doc-biblioref">Mercer et al. 2013</a>)</span>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infect_duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prob_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  infect_duration <span class="op">=</span> <span class="va">infect_duration</span>,</span>
<span>  prob_transmission <span class="op">=</span> <span class="va">prob_transmission</span></span>
<span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>  <span class="va">params</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/calc_network_R.html">calc_network_R</a></span><span class="op">(</span></span>
<span>      mean_num_contact <span class="op">=</span> <span class="fl">14.1</span>,</span>
<span>      sd_num_contact <span class="op">=</span> <span class="fl">69.6</span>,</span>
<span>      infect_duration <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"infect_duration"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      prob_transmission <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"prob_transmission"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      age_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">74</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">params</span>, <span class="va">R</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">res</span>,</span>
<span>  varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  v.names <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">infect_duration</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_transmission</span>,</span>
<span>      fill <span class="op">=</span> <span class="va">R</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">infect_duration</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_transmission</span>,</span>
<span>      z <span class="op">=</span> <span class="va">R</span></span>
<span>    <span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fl">1</span>,  <span class="co"># Set the contour line at R = 1</span></span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Mean duration of infectiousness"</span>,</span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Zika virus transmission probability per sexual partners"</span>,</span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span>,</span>
<span>    labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link">as_labeller</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>R <span class="op">=</span> <span class="st">"R"</span>, R_net <span class="op">=</span> <span class="st">"Adjusted R"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span></span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">R</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">R</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:plot-zika-r"></span>
<img src="heterogeneous_network_outbreaks_files/figure-html/plot-zika-r-1.png" alt="The reproduction number using the unadjusted and adjusted calculation -- calculated using `calc_network_R()` -- with mean duration of infection on the x-axis and transmission probability per sexual partner on the y-axis. The line shows the points that $R_0$ is equal to one. Both axes are plotted on a natural log scale. This plot is similar to Figure 1 from @yakobLowRiskSexuallytransmitted2016, but is plotted as a heatmap and without annotation."><p class="caption">
Figure 1: The reproduction number using the unadjusted and adjusted calculation – calculated using <code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> – with mean duration of infection on the x-axis and transmission probability per sexual partner on the y-axis. The line shows the points that <span class="math inline">\(R_0\)</span> is equal to one. Both axes are plotted on a natural log scale. This plot is similar to Figure 1 from <span class="citation">Yakob et al. (<a href="#ref-yakobLowRiskSexuallytransmitted2016" role="doc-biblioref">2016</a>)</span>, but is plotted as a heatmap and without annotation.
</p>
</div>
<p>Another study that showed the network effects on transmission of an STI was <span class="citation">Endo et al. (<a href="#ref-endoHeavytailedSexualContact2022" role="doc-biblioref">2022</a>)</span>, who estimated that Mpox (or monkeypox) could spread throughout a network on men who have sex with men (MSM), but would have lower transmissibility in the wider population. Using the Natsal UK data <span class="citation">(<a href="#ref-mercerChangesSexualAttitudes2013" role="doc-biblioref">Mercer et al. 2013</a>)</span> on same- and opposite-sex sexual partnerships for the age range of 18 to 44, they show that the disease transmission for MSM is greater than for a non-MSM transmission network. Because Mpox has a relatively short infectious period, this study assumed that contacts remained fixed during the period of infection, and hence used a next generation matrix approach more akin to the group-specific transmission defined in the <a href="https://epiverse-trace.github.io/finalsize/" class="external-link">finalsize package</a>.</p>
<p>For comparison, we produce a figure similar to <span class="citation">Endo et al. (<a href="#ref-endoHeavytailedSexualContact2022" role="doc-biblioref">2022</a>)</span>, using <code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> instead to show how highly connected individuals – who are more likely to acquire and pass on infection – alter the estimated <span class="math inline">\(R_0\)</span> compared to the simpler assumption of <span class="math inline">\(R_0 = SAR \times contacts\)</span>, under the assumptions described above.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">duration_years</span> <span class="op">&lt;-</span> <span class="fl">21</span> <span class="op">/</span> <span class="fl">365</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="va">beta</span>,</span>
<span>  <span class="va">calc_network_R</span>,</span>
<span>  mean_num_contact <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  sd_num_contact <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  infect_duration <span class="op">=</span> <span class="va">duration_years</span>,</span>
<span>  age_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">44</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">res</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">beta</span>, <span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">res</span>,</span>
<span>  varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  v.names <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"R_net"</span><span class="op">)</span>,</span>
<span>  timevar <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">beta</span>, y <span class="op">=</span> <span class="va">R</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Reproduction Number (R)"</span>,</span>
<span>    trans <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">breaks_log</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Secondary Attack Rate (SAR)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Reproduction Number"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"Adjusted R"</span><span class="op">)</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:plot-mpox"></span>
<img src="heterogeneous_network_outbreaks_files/figure-html/plot-mpox-1.png" alt="The reproduction number using the unadjusted and adjusted calculation -- calculated using `calc_network_R()` -- with secondary attack rate on the x-axis and reproduction number ($R_0$) on the y-axis. This plot is similar to Figure 2A from @endoHeavytailedSexualContact2022."><p class="caption">
Figure 2: The reproduction number using the unadjusted and adjusted calculation – calculated using <code><a href="../reference/calc_network_R.html">calc_network_R()</a></code> – with secondary attack rate on the x-axis and reproduction number (<span class="math inline">\(R_0\)</span>) on the y-axis. This plot is similar to Figure 2A from <span class="citation">Endo et al. (<a href="#ref-endoHeavytailedSexualContact2022" role="doc-biblioref">2022</a>)</span>.
</p>
</div>
<div class="alert alert-warning">
<p><em>Methodological caveat</em>: There is a link with the theory for the main negative binomial models from the <a href="https://epiverse-trace.github.io/superspreading/">superspreading package</a> here (which have a Gamma distributed mean), because the above Anderson and May formulation requires the ‘true’ mean and variance of the underlying static contact distribution, rather than the observed mean and variance. To give the superspreading version: in a simple branching process with fixed <span class="math inline">\(R_0\)</span> (i.e. zero variance in the individual-level reproduction number, perhaps because everyone has an identical number of contacts), the Poisson distributed number of transmissions per year measured exhibits more variation than the ‘true’ <span class="math inline">\(R_0\)</span> (which has zero variance). For the above STI model, taking the lifetime average deals with this problem some extent, because if we look at the sum of contacts over a large number of years, then calculate the mean per year, the observed distribution will converge as the number of years gets very large.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-endoHeavytailedSexualContact2022" class="csl-entry">
Endo, Akira, Hiroaki Murayama, Sam Abbott, Ruwan Ratnayake, Carl A. B. Pearson, W. John Edmunds, Elizabeth Fearon, and Sebastian Funk. 2022. <span>“Heavy-Tailed Sexual Contact Networks and Monkeypox Epidemiology in the Global Outbreak, 2022.”</span> <em>Science</em> 378 (6615): 90–94. <a href="https://doi.org/10.1126/science.add4507" class="external-link">https://doi.org/10.1126/science.add4507</a>.
</div>
<div id="ref-mayTransmissionDynamicsHuman1988" class="csl-entry">
May, Robert, and Roy Anderson. 1988. <span>“The Transmission Dynamics of Human Immunodeficiency Virus (HIV).”</span> <em>Philosophical Transactions of the Royal Society of London. B, Biological Sciences</em> 321 (1207): 565–607. <a href="https://doi.org/10.1098/rstb.1988.0108" class="external-link">https://doi.org/10.1098/rstb.1988.0108</a>.
</div>
<div id="ref-mercerChangesSexualAttitudes2013" class="csl-entry">
Mercer, Catherine H, Clare Tanton, Philip Prah, Bob Erens, Pam Sonnenberg, Soazig Clifton, Wendy Macdowall, et al. 2013. <span>“Changes in Sexual Attitudes and Lifestyles in Britain Through the Life Course and over Time: Findings from the National Surveys of Sexual Attitudes and Lifestyles (Natsal).”</span> <em>The Lancet</em> 382 (9907): 1781–94. <a href="https://doi.org/10.1016/S0140-6736(13)62035-8" class="external-link">https://doi.org/10.1016/S0140-6736(13)62035-8</a>.
</div>
<div id="ref-yakobLowRiskSexuallytransmitted2016" class="csl-entry">
Yakob, Laith, Adam Kucharski, Stephane Hue, and W John Edmunds. 2016. <span>“Low Risk of a Sexually-Transmitted Zika Virus Outbreak.”</span> <em>The Lancet Infectious Diseases</em> 16 (10): 1100–1102. <a href="https://doi.org/10.1016/S1473-3099(16)30324-3" class="external-link">https://doi.org/10.1016/S1473-3099(16)30324-3</a>.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joshua W. Lambert, Adam Kucharski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
