<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate individual-level transmission • superspreading</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate individual-level transmission">
<meta name="robots" content="noindex">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/superspreading.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6></li>
    <li><a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Proportion transmission</h6></li>
    <li><a class="dropdown-item" href="../articles/proportion_transmission.html">Methods for calculating the proportion of transmission</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Pathogen evolution and emergence</h6></li>
    <li><a class="dropdown-item" href="../articles/emergence.html">Pathogen evolution in the emergence of infectious disease outbreaks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate individual-level transmission</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/main/vignettes/estimate_individual_level_transmission.Rmd" class="external-link"><code>vignettes/estimate_individual_level_transmission.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_individual_level_transmission.Rmd</code></div>
    </div>

    
    
<p>The rate of growth or decline in the incidence of a transmissible
infectious disease is often quantified as the population-level
reproduction number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>).
However, there may be individual-level heterogeneity in transmission
that this metric does not capture.</p>
<p>In their landmark work, <span class="citation">Lloyd-Smith et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>
showed that variation in individual-level disease transmission often
exceed that of a poisson model and in some cases that of a geometric
model. They fit a negative binomial distribution to show that the
distribution of secondary cases displayed overdispersion, in other
words, the variance exceeded the mean. In the negative binomial
distribution this is quantified by the dispersion
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>)
parameter being less than 1.</p>
<p>This vignette demonstrates how to use the {superspreading} and
{fitdistrplus} R packages to estimate the parameters of individual-level
transmission and select the best fitting model.</p>
<p>Additionally, {ggplot2} is used for plotting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe-software.github.io/fitdistrplus/" class="external-link">fitdistrplus</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: survival</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="transmission-data">Transmission data<a class="anchor" aria-label="anchor" href="#transmission-data"></a>
</h2>
<p>For this example we use transmission chain data from <span class="citation">Faye et al. (<a href="#ref-fayeChainsTransmissionControl2015">2015</a>)</span> from the
Ebola virus disease (EVD) outbreak in West Africa, between the period
from February to August 2014. Specifically, this data reconstructs the
pathway of Ebola transmission in Conakry, Guinea.</p>
<p>This data has been used by <span class="citation">Althaus (<a href="#ref-althausEbolaSuperspreading2015">2015</a>)</span> to show that
the Ebola outbreak in Conakry displayed signatures of overdispersion
(i.e. superspreading events), and by <span class="citation">Kucharski et
al. (<a href="#ref-kucharskiEffectivenessRingVaccination2016">2016</a>)</span>
to determine the effectiveness of ring- and mass-vaccination campaigns
for ongoing Ebola outbreaks.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># total number of cases (i.e. individuals in transmission chain)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">152</span></span>
<span></span>
<span><span class="co"># number of secondary cases for all cases</span></span>
<span><span class="va">all_cases_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">14</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">17</span>, <span class="fl">2</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add zeros for each cases that did not cause a secondary case</span></span>
<span><span class="co"># (i.e. cases that did not transmit)</span></span>
<span><span class="va">all_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">all_cases_transmission</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">all_cases_transmission</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit a standard set of offspring distribution models:</span></span>
<span><span class="co"># - Poisson</span></span>
<span><span class="co"># - Geometric</span></span>
<span><span class="co"># - Negative Binomial</span></span>
<span></span>
<span><span class="va">pois_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"pois"</span><span class="op">)</span></span>
<span><span class="va">geom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"geom"</span><span class="op">)</span></span>
<span><span class="va">nbinom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"nbinom"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ic_tbl.html">ic_tbl</a></span><span class="op">(</span><span class="va">pois_fit</span>, <span class="va">geom_fit</span>, <span class="va">nbinom_fit</span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>  pattern <span class="op">=</span> <span class="st">"^Delta"</span>, replacement <span class="op">=</span> <span class="st">"$\\\\Delta$"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^w"</span>, replacement <span class="op">=</span> <span class="st">"$w$"</span>, x <span class="op">=</span> <span class="va">col.names</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">model_tbl</span>, col.names <span class="op">=</span> <span class="va">col.names</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">distribution</th>
<th align="right">AIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>AIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>AIC</th>
<th align="right">BIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>BIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>BIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nbinom</td>
<td align="right">358.4</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">364.4</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">geom</td>
<td align="right">413.6</td>
<td align="right">55.2</td>
<td align="right">0</td>
<td align="right">416.6</td>
<td align="right">52.1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">pois</td>
<td align="right">602.4</td>
<td align="right">244.0</td>
<td align="right">0</td>
<td align="right">605.4</td>
<td align="right">241.0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The best performing model, for both AIC and BIC comparison, is the
negative binomial.</p>
<p>AIC and BIC are model fitting metrics (information criterion) to
determine the model that best fits the data while penalising model
complexity to prevent overfitting and allows comparison of models with a
different number of parameters. In this case the Poisson and geometric
models have a single parameter, whereas the negative binomial has two
parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="co">#&gt;      size        mu </span></span>
<span><span class="co">#&gt; 0.1814260 0.9537995</span></span></code></pre></div>
<p>The parameter for the negative binomial show that there is
overdispersion (<code>size</code> is the dispersion parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
and <code>mu</code> is the mean, or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>)
in transmission and thus the EVD transmission chain data shows that
superspreading events are a possible realisation of EVD transmission
dynamics.</p>
<p>These values match those reported in <span class="citation">Althaus
(<a href="#ref-althausEbolaSuperspreading2015">2015</a>)</span> and here
we reproduce figure 1 from that paper to display the tail of the
distribution from which superspreading events can be possible.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tally cases</span></span>
<span><span class="va">tally</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">all_cases</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pad with zeros when number of cases not in tally</span></span>
<span><span class="va">num_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">21</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">num_cases</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">num_cases</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tally</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tally</span></span>
<span></span>
<span><span class="co"># convert cases to proportional of total cases to plot on the same scale as</span></span>
<span><span class="co"># the density</span></span>
<span><span class="va">prop_num_cases</span> <span class="op">&lt;-</span> <span class="va">num_cases</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">num_cases</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create data frame with proportion of cases, density and number of secondary</span></span>
<span><span class="co"># cases</span></span>
<span><span class="va">nbinom_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prop_num_cases <span class="op">=</span> <span class="va">prop_num_cases</span>,</span>
<span>  density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"size"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    mu <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"mu"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nbinom_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">prop_num_cases</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"cyan3"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#f58231"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#f58231"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of secondary cases"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="estimate_individual_level_transmission_files/figure-html/plot-nbinom-1.png" alt="A bar plot showing the frequency distribution of the number of secondary cases (x-axis, ranging from 0 to 20) versus frequency (y-axis, ranging from 0.0 to 0.7) from the empirical data. The distribution is heavily right-skewed with cyan coloured bars showing that the empirical data has a vast majority of cases (72%) produce zero secondary cases. The frequency drops sharply for higher numbers of secondary cases, 11% producing 1 secondary case, 6% producing 2 secondary cases, and progressively smaller percentages for higher numbers of secondary cases. An orange line with points overlays the histogram showing the probability mass function following the same pattern as the bars and extending across the full range to show the match between empirical data and negative binomial parameter estimates. The distribution illustrates the characteristic pattern of infectious disease transmission where most infected individuals transmit to few or no others, while a small proportion become superspreaders responsible for many secondary infections." width="768"><p class="caption">
Number of secondary cases from the empirical data (bar plot) and the
density of the negative binomial with the maximum likelihood estimates
when fit to the empirical data (points and line). This plot is
reproduced from Althaus (2015) figure 1.
</p>
</div>
<p>Next we partitioned the data into index cases and secondary cases
following <span class="citation">Kucharski et al. (<a href="#ref-kucharskiEffectivenessRingVaccination2016">2016</a>)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index_case_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">17</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">14</span><span class="op">)</span></span>
<span><span class="va">secondary_case_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Format data into index and non-index cases</span></span>
<span></span>
<span><span class="co"># total non-index cases</span></span>
<span><span class="va">n_non_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">index_case_transmission</span>, <span class="va">secondary_case_transmission</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># transmission from all non-index cases</span></span>
<span><span class="va">non_index_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">secondary_case_transmission</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n_non_index</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">secondary_case_transmission</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We fit the negative binomial model for both the index and non-index
case transmission events.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate R and k for index and non-index cases</span></span>
<span><span class="va">param_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">index_case_transmission</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"nbinom"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">param_index</span></span>
<span><span class="co">#&gt; Fitting of the distribution ' nbinom ' by maximum likelihood </span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt;      estimate Std. Error</span></span>
<span><span class="co">#&gt; size 1.596646   1.025029</span></span>
<span><span class="co">#&gt; mu   7.000771   2.320850</span></span>
<span><span class="va">param_non_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">non_index_cases</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"nbinom"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">param_non_index</span></span>
<span><span class="co">#&gt; Fitting of the distribution ' nbinom ' by maximum likelihood </span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt;       estimate Std. Error</span></span>
<span><span class="co">#&gt; size 0.1937490 0.05005421</span></span>
<span><span class="co">#&gt; mu   0.6619608 0.14197451</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="superspreading-using-alternative-distributions">Superspreading using alternative distributions<a class="anchor" aria-label="anchor" href="#superspreading-using-alternative-distributions"></a>
</h2>
<div class="alert alert-primary">
<p><strong>Advanced options</strong></p>
<p>This section of the vignette discusses some alternative transmission
models to quantify overdispersion and may be considered advanced in
comparison to the above example.</p>
</div>
<p>Research subsequent to <span class="citation">Lloyd-Smith et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>
has shown that contact data from infectious disease outbreaks often
shows signatures of overdispersion and can therefore cause
superspreading events. However, overdispersion can be modelled by other
distributions to the negative binomial.</p>
<p><span class="citation">Kremer et al. (<a href="#ref-kremerQuantifyingSuperspreadingCOVID192021">2021</a>)</span>
showed for SARS-CoV-2 that superspreading may be better modelled by a
Poisson mixture distribution (or Poisson compound distribution). Four
Poisson mixture distribution were applied: Poisson-Gamma,
Poisson-Lognormal, Poisson-Weibull, and Poisson-Generalised-Gamma;
finding the Poisson-lognormal and Poisson-Weibull fit best for three
data sets.</p>
<div class="alert alert-warning">
<p>The Poisson-Gamma distribution is the same as the negative binomial
distribution. Hereafter we refer to it is the negative binomial.</p>
</div>
<p>R has the density functions and cumulative distribution functions for
the Poisson (<code><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois()</a></code> and <code><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">ppois()</a></code>), geometric
(<code><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom()</a></code> and <code><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">pgeom()</a></code>) and negative binomial
(<code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom()</a></code> and <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">pnbinom()</a></code>) distributions, but
does not supply Poisson compound distributions.</p>
<p>In the {superspreading} R package we supply the density and
cumulative distribution functions for the Poisson-lognormal
(<code><a href="../reference/dpoislnorm.html">dpoislnorm()</a></code> and <code><a href="../reference/ppoislnorm.html">ppoislnorm()</a></code>) and
Poisson-Weibull (<code><a href="../reference/dpoisweibull.html">dpoisweibull()</a></code> and
<code><a href="../reference/ppoisweibull.html">ppoisweibull()</a></code>).</p>
<p>These functions can be used with {fitdistrplus}, as shown for the
other distributions above.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit an expanded set of offspring distribution models:</span></span>
<span><span class="co"># - Poisson</span></span>
<span><span class="co"># - Geometric</span></span>
<span><span class="co"># - Negative Binomial</span></span>
<span><span class="co"># - Poisson-lognormal compound</span></span>
<span><span class="co"># - Poisson-Weibull compound</span></span>
<span></span>
<span><span class="va">pois_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"pois"</span><span class="op">)</span></span>
<span><span class="va">geom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"geom"</span><span class="op">)</span></span>
<span><span class="va">nbinom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"nbinom"</span><span class="op">)</span></span>
<span><span class="va">poislnorm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">all_cases</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"poislnorm"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">1</span>, sdlog <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">poisweibull_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lbbe-software.github.io/fitdistrplus/reference/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">all_cases</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"poisweibull"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ic_tbl.html">ic_tbl</a></span><span class="op">(</span></span>
<span>  <span class="va">pois_fit</span>, <span class="va">geom_fit</span>, <span class="va">nbinom_fit</span>, <span class="va">poislnorm_fit</span>, <span class="va">poisweibull_fit</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>  pattern <span class="op">=</span> <span class="st">"^Delta"</span>, replacement <span class="op">=</span> <span class="st">"$\\\\Delta$"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^w"</span>, replacement <span class="op">=</span> <span class="st">"$w$"</span>, x <span class="op">=</span> <span class="va">col.names</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">model_tbl</span>, col.names <span class="op">=</span> <span class="va">col.names</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">distribution</th>
<th align="right">AIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>AIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>AIC</th>
<th align="right">BIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>BIC</th>
<th align="right">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>BIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nbinom</td>
<td align="right">358.4</td>
<td align="right">0.0</td>
<td align="right">0.6</td>
<td align="right">364.4</td>
<td align="right">0.0</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">poisweibull</td>
<td align="right">359.8</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="right">365.9</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
</tr>
<tr class="odd">
<td align="left">poislnorm</td>
<td align="right">362.8</td>
<td align="right">4.4</td>
<td align="right">0.1</td>
<td align="right">368.9</td>
<td align="right">4.4</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">geom</td>
<td align="right">413.6</td>
<td align="right">55.2</td>
<td align="right">0.0</td>
<td align="right">416.6</td>
<td align="right">52.1</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">pois</td>
<td align="right">602.4</td>
<td align="right">244.0</td>
<td align="right">0.0</td>
<td align="right">605.4</td>
<td align="right">241.0</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p>The negative binomial is still the best performing fitting model,
even with the addition of the Poisson-lognormal and Poisson-Weibull
models. Although the second best model, the Poisson-Weibull, performs
similarly well to the negative binomial
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>AIC
&lt; 2 &amp;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>BIC
&lt; 2).</p>
<p>Here we plot the density of each distribution given the maximum
likelihood estimates to inspect differences between the two
distributions.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create data frame with proportion of cases, density of each distribution</span></span>
<span><span class="va">dist_compare_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prop_num_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prop_num_cases</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"size"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      mu <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"mu"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    poisweibull_density <span class="op">=</span> <span class="fu"><a href="../reference/dpoisweibull.html">dpoisweibull</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      shape <span class="op">=</span> <span class="va">poisweibull_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"shape"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      scale <span class="op">=</span> <span class="va">poisweibull_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"scale"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Negative Binomial"</span>, <span class="fl">21</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Poisson-Weibull"</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dist_compare_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">prop_num_cases</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"cyan3"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x</span>,</span>
<span>      y <span class="op">=</span> <span class="va">dens</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">dist</span></span>
<span>    <span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">dens</span>, colour <span class="op">=</span> <span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of secondary cases"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Distribution"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#f58231"</span>, <span class="st">"#ffe119"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="estimate_individual_level_transmission_files/figure-html/plot-dists-1.png" alt="A histogram showing the frequency distribution of the number of secondary cases (x-axis, ranging from 0 to 20) versus frequency (y-axis, ranging from 0 to 0.7). The distribution is heavily right-skewed with cyan coloured bars showing that the empirical data has 72% of cases produce zero secondary cases. Two fitted distribution probability mass function curves are overlaid: an orange line with points representing the Negative Binomial distribution, and a yellow line with points representing the Poisson-Weibull distribution. Both estimated curves closely follow the observed data pattern. The frequency drops sharply from 0 secondary cases (0.72 frequency) to 1 secondary case (0.11 frequency), then continues to decline for higher numbers of secondary cases. This pattern illustrates the characteristic overdispersion in infectious disease transmission where most individuals infect few or no others, while a small proportion become superspreaders." width="768"><p class="caption">
Number of secondary cases from the empirical data (bar plot) and the
density of the negative binomial (orange) and poisson-Weibull (yellow)
with the maximum likelihood estimates when fit to the empirical data
(points and line).
</p>
</div>
<p>The fit of each model is very similar, as expected from the close AIC
and BIC (these models have the same numbers of free parameters). The
Poisson-Weibull compound distribution can adequately capture the
overdispersion in the EVD transmission data. A noticeable difference
between the models fitting to the number of cases that caused a single
secondary cases. Here the negative binomial matches the empirical data,
whereas the Poisson-Weibull slightly overestimates the number.</p>
<p>Overall, {superspreading} and {fitdistrplus} (or another fitting
package of your choice) can be used to estimate and understand
individual-level transmission dynamics when transmission chain data is
available.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-althausEbolaSuperspreading2015" class="csl-entry">
Althaus, Christian L. 2015. <span>“Ebola Superspreading.”</span> <em>The
Lancet Infectious Diseases</em> 15 (5): 507–8. <a href="https://doi.org/10.1016/S1473-3099(15)70135-0" class="external-link">https://doi.org/10.1016/S1473-3099(15)70135-0</a>.
</div>
<div id="ref-fayeChainsTransmissionControl2015" class="csl-entry">
Faye, Ousmane, Pierre-Yves Boëlle, Emmanuel Heleze, Oumar Faye, Cheikh
Loucoubar, N’Faly Magassouba, Barré Soropogui, et al. 2015.
<span>“Chains of Transmission and Control of Ebola Virus Disease in
Conakry, Guinea, in 2014: An Observational Study.”</span> <em>The Lancet
Infectious Diseases</em> 15 (3): 320–26. <a href="https://doi.org/10.1016/S1473-3099(14)71075-8" class="external-link">https://doi.org/10.1016/S1473-3099(14)71075-8</a>.
</div>
<div id="ref-kremerQuantifyingSuperspreadingCOVID192021" class="csl-entry">
Kremer, Cécile, Andrea Torneri, Sien Boesmans, Hanne Meuwissen, Selina
Verdonschot, Koen Vanden Driessche, Christian L. Althaus, Christel Faes,
and Niel Hens. 2021. <span>“Quantifying Superspreading for COVID-19
Using Poisson Mixture Distributions.”</span> <em>Scientific Reports</em>
11 (1): 14107. <a href="https://doi.org/10.1038/s41598-021-93578-x" class="external-link">https://doi.org/10.1038/s41598-021-93578-x</a>.
</div>
<div id="ref-kucharskiEffectivenessRingVaccination2016" class="csl-entry">
Kucharski, Adam J., Rosalind M. Eggo, Conall H. Watson, Anton Camacho,
Sebastian Funk, and W. John Edmunds. 2016. <span>“Effectiveness of Ring
Vaccination as Control Strategy for Ebola Virus Disease.”</span>
<em>Emerging Infectious Diseases</em> 22 (1): 105–8. <a href="https://doi.org/10.3201/eid2201.151410" class="external-link">https://doi.org/10.3201/eid2201.151410</a>.
</div>
<div id="ref-lloyd-smithSuperspreadingEffectIndividual2005" class="csl-entry">
Lloyd-Smith, J. O., S. J. Schreiber, P. E. Kopp, and W. M. Getz. 2005.
<span>“Superspreading and the Effect of Individual Variation on Disease
Emergence.”</span> <em>Nature</em> 438 (7066): 355–59. <a href="https://doi.org/10.1038/nature04153" class="external-link">https://doi.org/10.1038/nature04153</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Dillon C. Adam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
