<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="superspreading">
<title>Estimate individual-level transmission • superspreading</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate individual-level transmission">
<meta property="og:description" content="superspreading">
<meta property="og:image" content="https://epiverse-trace.github.io/superspreading/logo.svg">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-danger me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/superspreading.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6>
    <a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a>
    <a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6>
    <a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6>
    <a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate individual-level transmission</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/HEAD/vignettes/estimate_individual_level_transmission.Rmd" class="external-link"><code>vignettes/estimate_individual_level_transmission.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_individual_level_transmission.Rmd</code></div>
    </div>

    
    
<p>The rate of growth or decline in the incidence of a transmissible infectious disease
is often quantified as the population-level reproduction number (<span class="math inline">\(R\)</span>). However,
there may be individual-level heterogeneity in transmission that this metric does not capture.</p>
<p>In their landmark work, <span class="citation">Lloyd-Smith et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005" role="doc-biblioref">2005</a>)</span> showed
that variation in individual-level disease transmission often exceed that of a poisson
model and in some cases that of a geometric model. They fit a negative binomial
distribution to show that the distribution of secondary cases displayed overdispersion,
in other words, the variance exceeded the mean. In the negative binomial distribution
this is quantified by the dispersion (<span class="math inline">\(k\)</span>) parameter being less than 1.</p>
<p>This vignette demonstrates how to use the {superspreading} and {fitdistrplus} R
packages to estimate the parameters of individual-level transmission and select
the best fitting model.</p>
<p>Additionally, {ggplot2} is used for plotting.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus" class="external-link">fitdistrplus</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: survival</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</details><div class="section level2">
<h2 id="transmission-data">Transmission data<a class="anchor" aria-label="anchor" href="#transmission-data"></a>
</h2>
<p>For this example we use transmission chain data from <span class="citation">Faye et al. (<a href="#ref-fayeChainsTransmissionControl2015" role="doc-biblioref">2015</a>)</span> from the Ebola virus disease outbreak in West Africa, between the period from February to August 2014. Specifically, this data reconstructs the pathway of Ebola transmission in Conakry, Guinea.</p>
<p>This data has been used by <span class="citation">Althaus (<a href="#ref-althausEbolaSuperspreading2015" role="doc-biblioref">2015</a>)</span> to show that the Ebola outbreak in Conakry displayed signatures of overdispersion (i.e. superspreading events), and by <span class="citation">Kucharski et al. (<a href="#ref-kucharskiEffectivenessRingVaccination2016" role="doc-biblioref">2016</a>)</span> to determine the effectiveness of ring- and mass-vaccination campaigns for ongoing Ebola outbreaks.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># total number of cases (i.e. individuals in transmission chain)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">152</span></span>
<span></span>
<span><span class="co"># number of secondary cases for all cases</span></span>
<span><span class="va">all_cases_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">14</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">17</span>, <span class="fl">2</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add zeros for each cases that did not cause a secondary case</span></span>
<span><span class="co"># (i.e. cases that did not transmit)</span></span>
<span><span class="va">all_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">all_cases_transmission</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">all_cases_transmission</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit a standard set of offspring distribution models:</span></span>
<span><span class="co"># - Poisson</span></span>
<span><span class="co"># - Geometric</span></span>
<span><span class="co"># - Negative Binomial</span></span>
<span></span>
<span><span class="va">pois_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"pois"</span><span class="op">)</span></span>
<span><span class="va">geom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"geom"</span><span class="op">)</span></span>
<span><span class="va">nbinom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"nbinom"</span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ic_tbl.html">ic_tbl</a></span><span class="op">(</span><span class="va">pois_fit</span>, <span class="va">geom_fit</span>, <span class="va">nbinom_fit</span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>  pattern <span class="op">=</span> <span class="st">"^Delta"</span>, replacement <span class="op">=</span> <span class="st">"$\\\\Delta$"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^w"</span>, replacement <span class="op">=</span> <span class="st">"$w$"</span>, x <span class="op">=</span> <span class="va">col.names</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">model_tbl</span>, col.names <span class="op">=</span> <span class="va">col.names</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</details><table class="table">
<thead><tr class="header">
<th align="left">distribution</th>
<th align="right">AIC</th>
<th align="right">
<span class="math inline">\(\Delta\)</span>AIC</th>
<th align="right">
<span class="math inline">\(w\)</span>AIC</th>
<th align="right">BIC</th>
<th align="right">
<span class="math inline">\(\Delta\)</span>BIC</th>
<th align="right">
<span class="math inline">\(w\)</span>BIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nbinom</td>
<td align="right">358.4</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="right">364.4</td>
<td align="right">0.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">geom</td>
<td align="right">413.6</td>
<td align="right">55.2</td>
<td align="right">0</td>
<td align="right">416.6</td>
<td align="right">52.1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">pois</td>
<td align="right">602.4</td>
<td align="right">244.0</td>
<td align="right">0</td>
<td align="right">605.4</td>
<td align="right">241.0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The best performing model, for both AIC and BIC comparison, is the negative binomial.</p>
<p>AIC and BIC are model fitting metrics (information criterion) to determine the model
that best fits the data while penalising model complexity to prevent overfitting and allows
comparison of models with a different number of parameters. In this case the Poisson
and Geometric models have a single parameter, whereas the Negative binomial has two
parameters.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="co">#&gt;      size        mu </span></span>
<span><span class="co">#&gt; 0.1814260 0.9537995</span></span></code></pre></div>
</details><p>The parameter for the negative binomial show that there is overdispersion
(<code>size</code> is the dispersion parameter <span class="math inline">\(k\)</span>, and <code>mu</code> is the mean, or <span class="math inline">\(R\)</span>) in
transmission and thus the EVD transmission chain data shows that superspreading
events are a possible realisation of EVD transmission dynamics.</p>
<p>These values match those reported in <span class="citation">Althaus (<a href="#ref-althausEbolaSuperspreading2015" role="doc-biblioref">2015</a>)</span> and here
we reproduce figure 1 from that paper to display the tail of the distribution
from which superspreading events can be possible.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tally cases</span></span>
<span><span class="va">tally</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">all_cases</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pad with zeros when number of cases not in tally</span></span>
<span><span class="va">num_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">21</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">num_cases</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">num_cases</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tally</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tally</span></span>
<span></span>
<span><span class="co"># convert cases to proportional of total cases to plot on the same scale as</span></span>
<span><span class="co"># the density</span></span>
<span><span class="va">prop_num_cases</span> <span class="op">&lt;-</span> <span class="va">num_cases</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">num_cases</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create data frame with proportion of cases, density and number of secondary</span></span>
<span><span class="co"># cases</span></span>
<span><span class="va">nbinom_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prop_num_cases <span class="op">=</span> <span class="va">prop_num_cases</span>,</span>
<span>  density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"size"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    mu <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"mu"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nbinom_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">prop_num_cases</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"cyan3"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#f58231"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#f58231"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of secondary cases"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:plot-nbinom"></span>
<img src="estimate_individual_level_transmission_files/figure-html/plot-nbinom-1.png" alt="Number of secondary cases from the empirical data (bar plot) and the density of the negative binomial with the maximum likelihood estimates when fit to the empirical data (points and line). This plot is reproduced from Althaus (2015) figure 1."><p class="caption">
Figure 1: Number of secondary cases from the empirical data (bar plot) and the density of the negative binomial with the maximum likelihood estimates when fit to the empirical data (points and line). This plot is reproduced from Althaus (2015) figure 1.
</p>
</div>
<p>Next we partitioned the data into index cases and secondary cases following <span class="citation">Kucharski et al. (<a href="#ref-kucharskiEffectivenessRingVaccination2016" role="doc-biblioref">2016</a>)</span>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index_case_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">17</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">14</span><span class="op">)</span></span>
<span><span class="va">secondary_case_transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Format data into index and non-index cases</span></span>
<span></span>
<span><span class="co"># total non-index cases</span></span>
<span><span class="va">n_non_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">index_case_transmission</span>, <span class="va">secondary_case_transmission</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># transmission from all non-index cases</span></span>
<span><span class="va">non_index_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">secondary_case_transmission</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n_non_index</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">secondary_case_transmission</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><p>We fit the negative binomial model for both the index and non-index case transmission events.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate R and k for index and non-index cases</span></span>
<span><span class="va">param_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">index_case_transmission</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"nbinom"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">param_index</span></span>
<span><span class="co">#&gt; Fitting of the distribution ' nbinom ' by maximum likelihood </span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt;      estimate Std. Error</span></span>
<span><span class="co">#&gt; size 1.596646   1.025029</span></span>
<span><span class="co">#&gt; mu   7.000771   2.320850</span></span>
<span><span class="va">param_non_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">non_index_cases</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"nbinom"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">param_non_index</span></span>
<span><span class="co">#&gt; Fitting of the distribution ' nbinom ' by maximum likelihood </span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt;       estimate Std. Error</span></span>
<span><span class="co">#&gt; size 0.1937490 0.05005421</span></span>
<span><span class="co">#&gt; mu   0.6619608 0.14197451</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="superspreading-using-alternative-distributions">Superspreading using alternative distributions<a class="anchor" aria-label="anchor" href="#superspreading-using-alternative-distributions"></a>
</h2>
<div class="alert alert-primary">
<p><strong>Advanced options</strong></p>
<p>This section of the vignette discusses some alternative transmission models to
quantify overdispersion and may be considered advanced in comparison to the above
example.</p>
</div>
<p>Research subsequent to <span class="citation">Lloyd-Smith et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005" role="doc-biblioref">2005</a>)</span> has shown that
contact data from infectious disease outbreaks often shows signatures of overdispersion and can therefore cause superspreading events. However, overdispersion can be modelled by other distributions to the negative
binomial.</p>
<p><span class="citation">Kremer et al. (<a href="#ref-kremerQuantifyingSuperspreadingCOVID192021" role="doc-biblioref">2021</a>)</span> showed for SARS-CoV-2 that superspreading
may be better modelled by a Poisson mixture distribution (or Poisson compound distribution).
Four Poisson mixture distribution were applied: Poisson-Gamma, Poisson-Lognormal, Poisson-Weibull,
and Poisson-Generalised-Gamma; finding the Poisson-lognormal and Poisson-Weibull fit best
for three data sets.</p>
<div class="alert alert-warning">
<p>The Poisson-Gamma distribution is the same as the negative binomial distribution.
Hereafter we refer to it is the negative binomial.</p>
</div>
<p>R has the density functions and cumulative distribution functions for the poisson
(<code><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois()</a></code> and <code><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">ppois()</a></code>), geometric (<code><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom()</a></code> and <code><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">pgeom()</a></code>) and negative binomial
(<code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom()</a></code> and <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">pnbinom()</a></code>) distributions, but does not supply Poisson compound
distributions.</p>
<p>In the {superspreading} R package we supply the density and cumulative
distribution functions for the Poisson-lognormal (<code><a href="../reference/dpoislnorm.html">dpoislnorm()</a></code> and <code><a href="../reference/ppoislnorm.html">ppoislnorm()</a></code>)
and Poisson-Weibull (<code><a href="../reference/dpoisweibull.html">dpoisweibull()</a></code> and <code><a href="../reference/ppoisweibull.html">ppoisweibull()</a></code>).</p>
<p>These functions can be used with {fitdistrplus}, as shown for the other distributions above.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit an expanded set of offspring distribution models:</span></span>
<span><span class="co"># - Poisson</span></span>
<span><span class="co"># - Geometric</span></span>
<span><span class="co"># - Negative Binomial</span></span>
<span><span class="co"># - Poisson-lognormal compound</span></span>
<span><span class="co"># - Poisson-Weibull compound</span></span>
<span></span>
<span><span class="va">pois_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"pois"</span><span class="op">)</span></span>
<span><span class="va">geom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"geom"</span><span class="op">)</span></span>
<span><span class="va">nbinom_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_cases</span>, distr <span class="op">=</span> <span class="st">"nbinom"</span><span class="op">)</span></span>
<span><span class="va">poislnorm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">all_cases</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"poislnorm"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">1</span>, sdlog <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">poisweibull_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">all_cases</span>,</span>
<span>  distr <span class="op">=</span> <span class="st">"poisweibull"</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ic_tbl.html">ic_tbl</a></span><span class="op">(</span></span>
<span>  <span class="va">pois_fit</span>, <span class="va">geom_fit</span>, <span class="va">nbinom_fit</span>, <span class="va">poislnorm_fit</span>, <span class="va">poisweibull_fit</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span></span>
<span>  pattern <span class="op">=</span> <span class="st">"^Delta"</span>, replacement <span class="op">=</span> <span class="st">"$\\\\Delta$"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^w"</span>, replacement <span class="op">=</span> <span class="st">"$w$"</span>, x <span class="op">=</span> <span class="va">col.names</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">model_tbl</span>, col.names <span class="op">=</span> <span class="va">col.names</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</details><table class="table">
<thead><tr class="header">
<th align="left">distribution</th>
<th align="right">AIC</th>
<th align="right">
<span class="math inline">\(\Delta\)</span>AIC</th>
<th align="right">
<span class="math inline">\(w\)</span>AIC</th>
<th align="right">BIC</th>
<th align="right">
<span class="math inline">\(\Delta\)</span>BIC</th>
<th align="right">
<span class="math inline">\(w\)</span>BIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nbinom</td>
<td align="right">358.4</td>
<td align="right">0.0</td>
<td align="right">0.6</td>
<td align="right">364.4</td>
<td align="right">0.0</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="left">poisweibull</td>
<td align="right">359.8</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="right">365.9</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
</tr>
<tr class="odd">
<td align="left">poislnorm</td>
<td align="right">362.8</td>
<td align="right">4.4</td>
<td align="right">0.1</td>
<td align="right">368.9</td>
<td align="right">4.4</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">geom</td>
<td align="right">413.6</td>
<td align="right">55.2</td>
<td align="right">0.0</td>
<td align="right">416.6</td>
<td align="right">52.1</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">pois</td>
<td align="right">602.4</td>
<td align="right">244.0</td>
<td align="right">0.0</td>
<td align="right">605.4</td>
<td align="right">241.0</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p>The negative binomial is still the best performing fitting model, even with the addition of the Poisson-lognormal
and Poisson-Weibull models. Although the second best model, the Poisson-Weibull, performs similarly well to the
negative binomial (<span class="math inline">\(\Delta\)</span>AIC &lt; 2 &amp; <span class="math inline">\(\Delta\)</span>BIC &lt; 2).</p>
<p>Here we plot the density of each distribution given the maximum likelihood estimates to inspect differences
between the two distributions.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create data frame with proportion of cases, density of each distribution</span></span>
<span><span class="va">dist_compare_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prop_num_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prop_num_cases</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  dens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"size"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      mu <span class="op">=</span> <span class="va">nbinom_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"mu"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    poisweibull_density <span class="op">=</span> <span class="fu"><a href="../reference/dpoisweibull.html">dpoisweibull</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      shape <span class="op">=</span> <span class="va">poisweibull_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"shape"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      scale <span class="op">=</span> <span class="va">poisweibull_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[[</span><span class="st">"scale"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Negative Binomial"</span>, <span class="fl">21</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Poisson-Weibull"</span>, <span class="fl">21</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><details class="chunk-details"><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dist_compare_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">prop_num_cases</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"cyan3"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">x</span>,</span>
<span>      y <span class="op">=</span> <span class="va">dens</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">dist</span></span>
<span>    <span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">dens</span>, colour <span class="op">=</span> <span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of secondary cases"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Distribution"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#f58231"</span>, <span class="st">"#ffe119"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:plot-dists"></span>
<img src="estimate_individual_level_transmission_files/figure-html/plot-dists-1.png" alt="Number of secondary cases from the empirical data (bar plot) and the density of the negative binomial (orange) and poisson-Weibull (pink) with the maximum likelihood estimates when fit to the empirical data (points and line)."><p class="caption">
Figure 2: Number of secondary cases from the empirical data (bar plot) and the density of the negative binomial (orange) and poisson-Weibull (pink) with the maximum likelihood estimates when fit to the empirical data (points and line).
</p>
</div>
<p>The fit of each model is very similar, as expected from the close AIC and BIC (these models have the same numbers of free parameters).
The Poisson-Weibull compound distribution can adequately capture the overdispersion in the EVD transmission data. A noticeable difference
between the models fitting to the number of cases that caused a single secondary cases. Here the negative binomial matches the empirical
data, whereas the Poisson-Weibull slightly overestimates the number.</p>
<p>Overall, {superspreading} and {fitdistrplus} (or another fitting package of your choice) can be used to estimate and
understand individual-level transmission dynamics when transmission chain data is available.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-althausEbolaSuperspreading2015" class="csl-entry">
Althaus, Christian L. 2015. <span>“Ebola Superspreading.”</span> <em>The Lancet Infectious Diseases</em> 15 (5): 507–8. <a href="https://doi.org/10.1016/S1473-3099(15)70135-0" class="external-link">https://doi.org/10.1016/S1473-3099(15)70135-0</a>.
</div>
<div id="ref-fayeChainsTransmissionControl2015" class="csl-entry">
Faye, Ousmane, Pierre-Yves Boëlle, Emmanuel Heleze, Oumar Faye, Cheikh Loucoubar, N’Faly Magassouba, Barré Soropogui, et al. 2015. <span>“Chains of Transmission and Control of Ebola Virus Disease in Conakry, Guinea, in 2014: An Observational Study.”</span> <em>The Lancet Infectious Diseases</em> 15 (3): 320–26. <a href="https://doi.org/10.1016/S1473-3099(14)71075-8" class="external-link">https://doi.org/10.1016/S1473-3099(14)71075-8</a>.
</div>
<div id="ref-kremerQuantifyingSuperspreadingCOVID192021" class="csl-entry">
Kremer, Cécile, Andrea Torneri, Sien Boesmans, Hanne Meuwissen, Selina Verdonschot, Koen Vanden Driessche, Christian L. Althaus, Christel Faes, and Niel Hens. 2021. <span>“Quantifying Superspreading for COVID-19 Using Poisson Mixture Distributions.”</span> <em>Scientific Reports</em> 11 (1): 14107. <a href="https://doi.org/10.1038/s41598-021-93578-x" class="external-link">https://doi.org/10.1038/s41598-021-93578-x</a>.
</div>
<div id="ref-kucharskiEffectivenessRingVaccination2016" class="csl-entry">
Kucharski, Adam J., Rosalind M. Eggo, Conall H. Watson, Anton Camacho, Sebastian Funk, and W. John Edmunds. 2016. <span>“Effectiveness of Ring Vaccination as Control Strategy for Ebola Virus Disease.”</span> <em>Emerging Infectious Diseases</em> 22 (1): 105–8. <a href="https://doi.org/10.3201/eid2201.151410" class="external-link">https://doi.org/10.3201/eid2201.151410</a>.
</div>
<div id="ref-lloyd-smithSuperspreadingEffectIndividual2005" class="csl-entry">
Lloyd-Smith, J. O., S. J. Schreiber, P. E. Kopp, and W. M. Getz. 2005. <span>“Superspreading and the Effect of Individual Variation on Disease Emergence.”</span> <em>Nature</em> 438 (7066): 355–59. <a href="https://doi.org/10.1038/nature04153" class="external-link">https://doi.org/10.1038/nature04153</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joshua W. Lambert, Adam Kucharski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
