<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate what proportion of cases cause a certain proportion of transmission — proportion_transmission • superspreading</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate what proportion of cases cause a certain proportion of transmission — proportion_transmission"><meta name="description" content="Calculates the proportion of cases that cause a certain percentage of
transmission.
It is commonly estimated what proportion of cases cause 80% of transmission
(i.e. secondary cases).
This can be calculated using proportion_transmission() at varying values of
\(R\) and for different values of percentage transmission.
There are two methods for calculating the proportion of transmission,
\(p_{80}\) (default) and \(t_{20}\), see method argument or details for
more information."><meta property="og:description" content="Calculates the proportion of cases that cause a certain percentage of
transmission.
It is commonly estimated what proportion of cases cause 80% of transmission
(i.e. secondary cases).
This can be calculated using proportion_transmission() at varying values of
\(R\) and for different values of percentage transmission.
There are two methods for calculating the proportion of transmission,
\(p_{80}\) (default) and \(t_{20}\), see method argument or details for
more information."><meta property="og:image" content="https://epiverse-trace.github.io/superspreading/logo.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/superspreading.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6></li>
    <li><a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Proportion transmission</h6></li>
    <li><a class="dropdown-item" href="../articles/proportion_transmission.html">Methods for calculating the proportion of transmission</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Pathogen evolution and emergence</h6></li>
    <li><a class="dropdown-item" href="../articles/emergence.html">Pathogen evolution in the emergence of infectious disease outbreaks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate what proportion of cases cause a certain proportion of transmission</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/main/R/proportion_transmission.R" class="external-link"><code>R/proportion_transmission.R</code></a></small>
      <div class="d-none name"><code>proportion_transmission.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the proportion of cases that cause a certain percentage of
transmission.</p>
<p>It is commonly estimated what proportion of cases cause 80% of transmission
(i.e. secondary cases).
This can be calculated using <code>proportion_transmission()</code> at varying values of
\(R\) and for different values of percentage transmission.</p>
<p>There are two methods for calculating the proportion of transmission,
\(p_{80}\) (default) and \(t_{20}\), see <code>method</code> argument or details for
more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">proportion_transmission</span><span class="op">(</span></span>
<span>  <span class="va">R</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  <span class="va">prop_transmission</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_80"</span>, <span class="st">"t_20"</span><span class="op">)</span>,</span>
<span>  simulate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">offspring_dist</span>,</span>
<span>  format_prop <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>A <code>number</code> specifying the \(R\) parameter (i.e. average
secondary cases per infectious individual).</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>A <code>number</code> specifying the  \(k\) parameter (i.e. dispersion in
offspring distribution from fitted negative binomial).</p></dd>


<dt id="arg-prop-transmission">prop_transmission<a class="anchor" aria-label="anchor" href="#arg-prop-transmission"></a></dt>
<dd><p>A <code>number</code> of the proportion of transmission
for which a proportion of cases has produced. Must be between 0 and 1
(exclusive, \((0, 1)\)).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A <code>character</code> string defining which method is used to calculate
the proportion of transmission. Options are <code>"p_80"</code> (default) or <code>"t_20"</code>.
See details for more information on each of these methods.</p></dd>


<dt id="arg-simulate">simulate<a class="anchor" aria-label="anchor" href="#arg-simulate"></a></dt>
<dd><p>A <code>logical</code> whether the calculation should be done
numerically (i.e. simulate secondary contacts) or analytically. Default is
<code>FALSE</code> which uses the analytical calculation.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/dots.html" class="external-link">dots</a> not used, extra arguments supplied will cause a warning.</p></dd>


<dt id="arg-offspring-dist">offspring_dist<a class="anchor" aria-label="anchor" href="#arg-offspring-dist"></a></dt>
<dd><p>An <code>&lt;epiparameter&gt;</code> object. An S3 class for working
with epidemiological parameters/distributions, see
<code><a href="https://epiverse-trace.github.io/epiparameter/reference/epiparameter.html" class="external-link">epiparameter::epiparameter()</a></code>.</p></dd>


<dt id="arg-format-prop">format_prop<a class="anchor" aria-label="anchor" href="#arg-format-prop"></a></dt>
<dd><p>A <code>logical</code> determining whether the proportion column
of the <code>&lt;data.frame&gt;</code> returned by the function is formatted as a string
with a percentage sign (<code>%</code>), (<code>TRUE</code>, default), or as a <code>numeric</code>
(<code>FALSE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>&lt;data.frame&gt;</code> with the value for the proportion of cases for a
given value of R and k.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Calculates the expected proportion of transmission from a given
proportion of infectious cases. There are two methods to calculate this with
distinct formulations, \(p_{80}\) and \(t_{20}\) these can be specified
by the <code>method</code> argument.</p>
<p><code>method = p_80</code> calculates relative transmission heterogeneity
from the offspring distribution of secondary cases, \(Z\), where the upper
proportion of the distribution comprise \(x\%\) of total number of cases
given R0 and k, where \(x\) is typically defined as 0.8 or 80%. e.g. 80%
of all transmissions are generated by the upper 20% of cases, or
<code>p_80 = 0.2</code>, per the 80/20 rule. In this formulation, changes in R can
have a significant effect on the estimate of \(p_{80}\) even when \(k\)
is constant. Importantly, this formulation <strong>does not</strong> allow for true
homogeneity when <code>k = Inf</code> i.e. \(p_{80} = 0.8\).</p>
<p><code>method = t_20</code> calculates a similar ratio, instead in terms of
the theoretical individual reproductive number and infectiousness given
\(R_0\) and \(k\). The individual reproductive number, \(\nu\), is
described in Lloyd-Smith et al. (2005), "as a random variable representing
the expected number of secondary cases caused by a particular infected
individual. Values for \(\nu\) are drawn from a continuous gamma
probability distribution with population mean \(R_0\) and dispersion
parameter \(k\), which encodes all variation in infectious histories of
individuals, including properties of the host and pathogen and environmental
circumstances." The value of \(k\) corresponds to the shape parameters of
the gamma distribution which encodes the variation in the gamma-Poisson
mixture a.k.a. the negative binomial.</p>
<p>For <code>method = t_20</code>, we define the upper proportion of infectiousness,
which is typically 0.2 i.e. the upper 20% most infectious
cases, again per the 80/20 rule. e.g. the most infectious 20% of cases,
are expected to produce 80% of all infections, or <code>t_20 = 0.8</code>. Unlike
<code>method = p_80</code>, changes in R have no effect on the estimate
of t_80 when k is constant, but R is still required for the underlying
calculation. This formulation <strong>does</strong> allow for true homogeneity when
<code>k = Inf</code> i.e. <code>t_20 = 0.2</code>, or <code>t_80 = 0.8</code>.</p>
<p>Multiple values of <code>R</code> and <code>k</code> can be supplied and a <code>&lt;data.frame&gt;</code> of
every combination of these will be returned.</p>
<p>The numerical calculation for <code>method = p_80</code> uses random number generation
to simulate secondary contacts so the answers may minimally vary between
calls. The number of simulation replicates is fixed to 10<sup>5</sup>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>The analytical calculation is from:</p>
<p>Endo, A., Abbott, S., Kucharski, A. J., &amp; Funk, S. (2020)
Estimating the overdispersion in COVID-19 transmission using outbreak
sizes outside China. Wellcome Open Research, 5.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3" class="external-link">doi:10.12688/wellcomeopenres.15842.3</a></p>
<p>The \(t_{20}\) method follows the formula defined in section 2.2.5 of the
supplementary material for:</p>
<p>Lloyd-Smith, J. O., Schreiber, S. J., Kopp, P. E., &amp; Getz, W. M. (2005)
Superspreading and the effect of individual variation on disease emergence.
Nature. Nov;438(7066):355–9. <a href="https://doi.org/10.1038/nature04153" class="external-link">doi:10.1038/nature04153</a></p>
<p>The original code for the \(t_{20}\) method is from ongoing work
originating from <a href="https://github.com/dcadam/kt" class="external-link">https://github.com/dcadam/kt</a> and:</p>
<p>Adam, D., Gostic, K., Tsang, T., Wu, P., Lim, W. W., Yeung, A., Wong, J.,
Lau, E., Du, Z., Chen, D., Ho, L.-M., Martín-Sánchez, M., Cauchemez, S.,
Cobey, S., Leung, G., &amp; Cowling, B. (2022) Time-varying transmission
heterogeneity of SARS and COVID-19 in Hong Kong.
<a href="https://doi.org/10.21203/rs.3.rs-1407962/v1" class="external-link">doi:10.21203/rs.3.rs-1407962/v1</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example of single values of R and k</span></span></span>
<span class="r-in"><span><span class="va">prop_transmission</span> <span class="op">&lt;-</span> <span class="fl">0.8</span> <span class="co"># 80% of transmission</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="fu">proportion_transmission</span><span class="op">(</span></span></span>
<span class="r-in"><span>  R <span class="op">=</span> <span class="va">R</span>,</span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>  prop_transmission <span class="op">=</span> <span class="va">prop_transmission</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   R   k prop_80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2 0.5   26.4%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example with multiple values of k</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">proportion_transmission</span><span class="op">(</span></span></span>
<span class="r-in"><span>  R <span class="op">=</span> <span class="va">R</span>,</span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>  prop_transmission <span class="op">=</span> <span class="va">prop_transmission</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   R   k prop_80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2 0.1   9.21%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2 0.2   15.6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2 0.3   20.3%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2 0.4   23.8%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2 0.5   26.4%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2 1.0   35.6%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example with vectors of R and k</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">proportion_transmission</span><span class="op">(</span></span></span>
<span class="r-in"><span>  R <span class="op">=</span> <span class="va">R</span>,</span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="va">k</span>,</span></span>
<span class="r-in"><span>  prop_transmission <span class="op">=</span> <span class="va">prop_transmission</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    R   k prop_80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 0.1   8.69%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2 0.1   9.21%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3 0.1   9.39%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1 0.2   14.3%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2 0.2   15.6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  3 0.2     16%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1 0.3   18.2%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2 0.3   20.3%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  3 0.3     21%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1 0.4   20.8%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2 0.4   23.8%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 3 0.4     25%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 1 0.5   22.6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2 0.5   26.4%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 3 0.5     28%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 1 1.0     30%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2 1.0   35.6%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 3 1.0   37.8%</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Dillon C. Adam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer></div>





  </body></html>

