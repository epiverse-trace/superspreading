<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Epidemic Risk • superspreading</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Epidemic Risk">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/superspreading.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6></li>
    <li><a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Proportion transmission</h6></li>
    <li><a class="dropdown-item" href="../articles/proportion_transmission.html">Methods for calculating the proportion of transmission</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Pathogen evolution and emergence</h6></li>
    <li><a class="dropdown-item" href="../articles/emergence.html">Pathogen evolution in the emergence of infectious disease outbreaks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Epidemic Risk</h1>
            <h3 data-toc-skip class="subtitle">Superspreading on policy,
decision making and control measures</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/v0.4.0/vignettes/epidemic_risk.Rmd" class="external-link"><code>vignettes/epidemic_risk.Rmd</code></a></small>
      <div class="d-none name"><code>epidemic_risk.Rmd</code></div>
    </div>

    
    
<div class="alert alert-info">
<p><strong>New to the {superspreading} package?</strong></p>
<p>See the <a href="https://epiverse-trace.github.io/superspreading/articles/superspreading.html">Get
started</a> vignette for an introduction to the concepts discussed below
and some of the functions included in the R package.</p>
</div>
<p>During the early stages of an infectious disease outbreak information
on transmission clusters and heterogeneity in individual-level
transmission can provide insight into the occurrence of superspreading
events and from this the probability an outbreak will cause an epidemic.
This has implications for policy decisions on how to bring disease
transmission under control
(e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
&lt; 1) and increase the probability that an outbreak goes extinct.</p>
<p>A recent example of where individual-level transmission and
superspreading were analysed to understand disease transmission was by
the <a href="https://www.gov.uk/government/organisations/scientific-advisory-group-for-emergencies" class="external-link">Scientific
Advisory Group for Emergencies (SAGE)</a> for the <a href="https://www.gov.uk/government/publications/analysis-of-sars-cov-2-transmission-clusters-and-superspreading-events-3-june-2020" class="external-link">UK’s
COVID-19 response</a>.</p>
<p>This vignette explores the applications of the functions included in
the {superspreading} package and their visualisation in understanding
and informing decision-makers for a variety of outbreak scenarios.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/" class="external-link">ggtext</a></span><span class="op">)</span></span></code></pre></div>
<p>Early in the COVID-19 epidemic, a number of studies including <span class="citation">Kucharski et al. (<a href="#ref-kucharskiEarlyDynamicsTransmission2020">2020</a>)</span>
investigated whether data on SARS-CoV-2 incidence had evidence of
superspreading events. These events are often estimated as some measure
of overdispersion. This was in light of evidence that other coronavirus
outbreaks (Severe acute respiratory syndrome (SARS) and Middle East
respiratory syndrome (MERS)) had superspreading events. The detection of
variability in individual-transmission is important in understanding or
predicting the likelihood of transmission establishing when imported
into a new location (e.g. country).</p>
<p>First we set up the parameters to use for calculating the probability
of an epidemic. In this case we are varying the heterogeneity of
transmission (<code>k</code>) and number of initial infections
(<code>num_init_infect</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">epidemic_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">2.35</span>,</span>
<span>  R_lw <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  R_up <span class="op">=</span> <span class="fl">3.2</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  num_init_infect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then we calculate the probability of an epidemic for each parameter
combination. The results are combined with the the parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># results are transposed to pivot to long rather than wide data</span></span>
<span><span class="va">prob_epidemic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">epidemic_params</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">central</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_epidemic.html">probability_epidemic</a></span><span class="op">(</span></span>
<span>    R <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    k <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"k"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    num_init_infect <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"num_init_infect"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_epidemic.html">probability_epidemic</a></span><span class="op">(</span></span>
<span>    R <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R_lw"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    k <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"k"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    num_init_infect <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"num_init_infect"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_epidemic.html">probability_epidemic</a></span><span class="op">(</span></span>
<span>    R <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R_up"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    k <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"k"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    num_init_infect <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"num_init_infect"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>prob_epidemic <span class="op">=</span> <span class="va">central</span>, prob_epidemic_lw <span class="op">=</span> <span class="va">lower</span>, prob_epidemic_up <span class="op">=</span> <span class="va">upper</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">epidemic_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">epidemic_params</span>, <span class="va">prob_epidemic</span><span class="op">)</span></span></code></pre></div>
<p>To visualise the influence of transmission variation (<code>k</code>)
we subset the results to only include those with a single initial
infection seeding transmission (<code>num_init_infect = 1</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset data for a single initial infection</span></span>
<span><span class="va">homogeneity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">epidemic_params</span>, <span class="va">num_init_infect</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot probability of epidemic across dispersion</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">homogeneity</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">k</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">prob_epidemic_lw</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">prob_epidemic_up</span></span>
<span>    <span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"grey70"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">prob_epidemic</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.15</span>, y <span class="op">=</span> <span class="fl">0.75</span>, label <span class="op">=</span> <span class="st">"SARS"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.45</span>, y <span class="op">=</span> <span class="fl">0.75</span>, label <span class="op">=</span> <span class="st">"MERS"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of large outbreak"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Extent of homogeneity in transmission"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="epidemic_risk_files/figure-html/plot-dispersion-1.png" alt="A graph showing the relationship between extent of homogeneity in transmission (x-axis, from 0 to 1) and probability of a large outbreak (y-axis, from 0 to 1). A black curved line shows an increasing relationship, starting near 0 and rising to 0.57, with the curve flattening as homogeneity increases. A grey shaded area around the line indicates confidence intervals, widening toward higher homogeneity values. Two vertical dashed lines mark specific diseases: SARS at 0.2 extent of homogeneity (corresponding to a 0.23 probability of large outbreak), and MERS at 0.4 extent of homogeneity (corresponding to 0.37 probability of large outbreak). The graph illustrates that diseases with more homogeneous transmission patterns have higher probabilities of causing large outbreaks." width="768"><p class="caption">
The probability that an initial infection (introduction) will cause a
sustained outbreak (transmission chain). The dispersion of the
individual-level transmission is plotted on the x-axis and probability
of outbreak – calculated using <code><a href="../reference/probability_epidemic.html">probability_epidemic()</a></code> – is
on the y-axis. This plot is reproduced from <span class="citation">Kucharski et al. (<a href="#ref-kucharskiEarlyDynamicsTransmission2020">2020</a>)</span>
figure 3A.
</p>
</div>
<p>The degree of variability in transmission increases as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
decreases <span class="citation">(<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">Lloyd-Smith et
al. 2005</a>)</span>. So the probability of a large outbreak is smaller
for smaller values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
for a given value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
meaning that if COVID-19 is more similar to SARS than MERS it will be
less likely to establish and cause an outbreak if introduced into a
newly susceptible population.</p>
<p>However, this probability of establishment and continued transmission
will also depend on the number of initial introductions to that
populations. The more introductions, the higher the chance one will lead
to an epidemic.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">introductions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">epidemic_params</span>, <span class="va">k</span> <span class="op">==</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot probability of epidemic across introductions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">introductions</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">num_init_infect</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_epidemic</span>,</span>
<span>      ymin <span class="op">=</span> <span class="va">prob_epidemic_lw</span>,</span>
<span>      ymax <span class="op">=</span> <span class="va">prob_epidemic_up</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of large outbreak"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of introductions"</span>, n.breaks <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="epidemic_risk_files/figure-html/plot-introductions-1.png" alt="A scatter plot showing the relationship between the number of introductions of an infectious disease (x-axis, ranging from 0 to 10) and the probability of large outbreak (y-axis, ranging from 0 to 1). Each point estimate has vertical error bars showing confidence intervals. The plot shows a clear increasing trend: starting at 0 introductions with 0% probability of large outbreak, rising to 42% at 1 introduction, 66% at 2 introductions, 81% at 3 introductions, 89% at 4 introductions, 93% at 5 introductions, 96% at 6 introductions, and plateauing near 99% for 7-10 introductions. The confidence intervals are widest at intermediate values (1-5 introductions). The pattern demonstrates the more introduction increase the probability of a large outbreak but has minimal impact once the probability approaches 1." width="768"><p class="caption">
The probability that a number of introduction events will cause a
sustained outbreak (transmission chain). The number of disease
introductions is plotted on the x-axis and probability of outbreak –
calculated using <code><a href="../reference/probability_epidemic.html">probability_epidemic()</a></code> – is on the y-axis.
This plot is reproduced from Kucharski et al. (2020) figure 3B.
</p>
</div>
<p>Different levels of heterogeneity in transmission will produce
different probabilities of epidemics.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot probability of epidemic across introductions for multiple k</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epidemic_params</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">num_init_infect</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_epidemic</span>,</span>
<span>      colour <span class="op">=</span> <span class="va">k</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of large outbreak"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Dispersion (*k*)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of introductions"</span>, n.breaks <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_colour_continuous</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="epidemic_risk_files/figure-html/plot-introductions-multi-k-1.png" alt="A scatter plot showing the relationship between the number of introductions (x-axis, ranging from 0 to 10) and the probability of a large outbreak (y-axis, ranging from 0 to 1). Points are coloured according to a dispersion parameter (k) ranging from 0 (purple) to 1.00 (yellow), as shown in the legend. The plot demonstrates that higher dispersion values (yellow and green points) consistently show higher probabilities of large outbreaks across all numbers of introductions. For any given number of introductions, there is a clear gradient from low outbreak probability (purple points at bottom) to high outbreak probability (yellow points at top). The relationship shows that both the number of introductions and the dispersion parameter influence outbreak probability, with the steepest increases occurring between 1-4 introductions." width="768"><p class="caption">
The probability that an a number of introduction events will cause a
sustained outbreak (transmission chain). The number of disease
introductions is plotted on the x-axis and probability of outbreak –
calculated using <code><a href="../reference/probability_epidemic.html">probability_epidemic()</a></code> – is on the y-axis.
Different values of dispersion are plotted to show the effect of
increased transmission variability on an epidemic establishing
</p>
</div>
<p>In the above plot we drop the uncertainty around each point and
assume a known value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
in order to more clearly show the pattern.</p>
<p>These calculations enable us to understand epidemics and
applications, such as Shiny apps, to explore this functionality and
compare between existing parameter estimates of offspring distributions
are also useful. An example application called <a href="https://cmmid.github.io/visualisations" class="external-link">Probability of a large
2019-nCoV outbreak following introduction of cases</a>, that is no
longer maintained, was developed by the Centre for Mathematical
Modelling of Infectious diseases at the London School of Hygiene and
Tropical Medicine, for comparing SARS-like and MERS-like scenarios, as
well as random mixing during the COVID-19 pandemic.</p>
<p>Conversely to the probability of an epidemic, the probability that an
outbreak will go extinct (i.e. transmission will subside), can also be
plotted for different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extinction_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  num_init_infect <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># results are transposed to pivot to long rather than wide data</span></span>
<span><span class="va">prob_extinct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">extinction_params</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">central</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/probability_extinct.html">probability_extinct</a></span><span class="op">(</span></span>
<span>    R <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    k <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"k"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    num_init_infect <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"num_init_infect"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">central</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">extinction_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">extinction_params</span>, <span class="va">prob_extinct</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot probability of extinction across R for multiple k</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">extinction_params</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">R</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_extinct</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of extinction"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Dispersion (*k*)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Reproductive number (*R*)"</span>,</span>
<span>    n.breaks <span class="op">=</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="epidemic_risk_files/figure-html/plot-extinction-1.png" alt="A scatter plot showing the relationship between the reproduction number (R) (x-axis, ranging from 0 to 5) and the probability of extinction (y-axis, ranging from 0 to 1). Points are discretely coloured according to a dispersion parameter (k) ranging from 0.01 (purple) to infinite (yellow), with intermediate values of 0.1, 0.5, 1 and 4, as shown in the legend. The plot demonstrates that higher dispersion values (yellow and green points) consistently show lower probabilities of extinction across all reproduction numbers greater than 1. All points for reproduction numbers below 1 have a probability of extinction at 1. The probability of extinction declines sharply in an exponential-like fashion for higher dispersion values, whereas smaller values of dispersion have a more gradual decline with higher reproduction numbers." width="768"><p class="caption">
The probability that an infectious disease will go extinct for a given
value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
This is calculated using <code><a href="../reference/probability_extinct.html">probability_extinct()</a></code> function.
This plot is reproduced from <span class="citation">Lloyd-Smith et al.
(<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>
figure 2B.
</p>
</div>
<div class="section level2">
<h2 id="superspreading-in-decision-making">Superspreading in decision making<a class="anchor" aria-label="anchor" href="#superspreading-in-decision-making"></a>
</h2>
<p>One of the first tasks in an outbreak is to establish whether
estimates of individual-level transmission variability have been
reported, either for this outbreak or a previous outbreak of the same
pathogen. Alternatively, if it is an outbreak of a novel pathogen,
parameters for similar pathogens can be searched for.</p>
<p>This is accomplished by another Epiverse-TRACE R package: <a href="https://epiverse-trace.github.io/epiparameter/index.html" class="external-link">{epiparameter}</a>.
This package contains a library of epidemiological parameters included
offspring distribution parameter estimates and uncertainty obtained from
published literature. This aids the collation and establishes a baseline
understanding of transmission. Similar to the collation of transmission
clusters for <a href="https://www.gov.uk/government/publications/analysis-of-sars-cov-2-transmission-clusters-and-superspreading-events-3-june-2020" class="external-link">COVID-19</a>.</p>
<p>Equipped with these parameter estimates, metrics that provide an
intuitive understanding of transmission patterns can be tabulated. For
example the proportion of transmission events in a given cluster size
can be calculated using the {superspreading} function
<code><a href="../reference/proportion_cluster_size.html">proportion_cluster_size()</a></code>.</p>
<p>This calculates the proportion of new cases that originate within a
transmission cluster of a given size. In other words, what proportion of
all transmission events were part of secondary case clusters (i.e. from
the same primary case) of at least, for example, five cases. This
calculation is useful to inform backwards contact tracing efforts.</p>
<p>In this example we look at clusters of at least 5, 10 and 25
secondary cases, at different numbers of initial infections and for two
reproduction numbers to see how this affects cluster sizes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For R = 0.8</span></span>
<span><span class="fu"><a href="../reference/proportion_cluster_size.html">proportion_cluster_size</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  cluster_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;      R   k prop_5 prop_10 prop_25</span></span>
<span><span class="co">#&gt; 1  0.8 0.1  66.8%   38.7%   7.36%</span></span>
<span><span class="co">#&gt; 2  0.8 0.2  48.6%     18%  0.786%</span></span>
<span><span class="co">#&gt; 3  0.8 0.3  37.7%   9.37%  0.197%</span></span>
<span><span class="co">#&gt; 4  0.8 0.4  30.3%   5.24% 0.0324%</span></span>
<span><span class="co">#&gt; 5  0.8 0.5  24.5%   3.07%      0%</span></span>
<span><span class="co">#&gt; 6  0.8 0.6  21.2%   1.68%      0%</span></span>
<span><span class="co">#&gt; 7  0.8 0.7  18.2%   1.11%      0%</span></span>
<span><span class="co">#&gt; 8  0.8 0.8    16%  0.925%      0%</span></span>
<span><span class="co">#&gt; 9  0.8 0.9  14.5%    0.6%      0%</span></span>
<span><span class="co">#&gt; 10 0.8 1.0  12.7%  0.445%      0%</span></span>
<span></span>
<span><span class="co"># For R = 3</span></span>
<span><span class="fu"><a href="../reference/proportion_cluster_size.html">proportion_cluster_size</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  cluster_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    R   k prop_5 prop_10 prop_25</span></span>
<span><span class="co">#&gt; 1  3 0.1  90.3%   78.4%   50.5%</span></span>
<span><span class="co">#&gt; 2  3 0.2  84.1%   64.8%   27.1%</span></span>
<span><span class="co">#&gt; 3  3 0.3  79.5%   55.2%   15.8%</span></span>
<span><span class="co">#&gt; 4  3 0.4  75.9%   47.6%   9.35%</span></span>
<span><span class="co">#&gt; 5  3 0.5  73.1%   42.1%   6.09%</span></span>
<span><span class="co">#&gt; 6  3 0.6  70.5%   36.8%   3.57%</span></span>
<span><span class="co">#&gt; 7  3 0.7  68.2%   32.7%   2.04%</span></span>
<span><span class="co">#&gt; 8  3 0.8  66.3%   29.6%   1.63%</span></span>
<span><span class="co">#&gt; 9  3 0.9  64.7%   26.7%   0.95%</span></span>
<span><span class="co">#&gt; 10 3 1.0  63.1%   23.9%  0.695%</span></span></code></pre></div>
<p>These results show that as the level of heterogeneity in
individual-level transmission increases, a larger percentage of cases
come from larger cluster sizes, and that large clusters can be produced
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
is higher even with low levels of transmission variation.</p>
<p>It indicates whether preventing gatherings of a certain size can
reduce the epidemic by preventing potential superspreading events.</p>
<p>When data on the settings of transmission is known, priority can be
given to restricting particular types of gatherings to most effectively
bring down the reproduction number.</p>
</div>
<div class="section level2">
<h2 id="controls-on-transmission">Controls on transmission<a class="anchor" aria-label="anchor" href="#controls-on-transmission"></a>
</h2>
<p>In their work on identifying the prevalence of overdispersion in
individual-level transmission, <span class="citation">Lloyd-Smith et al.
(<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>
also showed the effect of control measures on the probability of
containment. They defined containment as the size of a transmission
chain not reaching 100 cases. They assumed the implementation of control
measures at the individual or population level. {superspreading}
provides <code><a href="../reference/probability_contain.html">probability_contain()</a></code> to calculate the probability
that an outbreak will go extinct before reaching a threshold size.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contain_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">3</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="cn">Inf</span><span class="op">)</span>, num_init_infect <span class="op">=</span> <span class="fl">1</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">prob_contain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">contain_params</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/probability_contain.html">probability_contain</a></span><span class="op">(</span></span>
<span>    R <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    k <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"k"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    num_init_infect <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"num_init_infect"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    pop_control <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"control"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">contain_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">contain_params</span>, <span class="va">prob_contain</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot probability of epidemic across introductions for multiple k</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">contain_params</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">control</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_contain</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of containment"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Control measures (*c*)"</span>, n.breaks <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Dispersion (*k*)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="epidemic_risk_files/figure-html/plot-containment-1.png" alt="A scatter plot showing the relationship between the strength of outbreak control measures (c) (x-axis, ranging from 0 to 1) and the probability of containment (y-axis, ranging from 0 to 1). Points are discretely coloured according to a dispersion parameter (k) ranging from 0.1 (purple) to infinite (yellow), with intermediate values of 0.5 and 1, as shown in the legend. The plot demonstrates that the probability of outbreak containment increases with greater control measures, with lower dispersion values having a higher probability of containment than higher dispersion values for each control measure value. Once control measures reach 0.7 all dispersion values converge to a probability of containment of 1." width="768"><p class="caption">
The probability that an outbreak will be contained (i.e. not exceed 100
cases) for a variety of population-level control measures. The
probability of containment is calculated using
<code><a href="../reference/probability_contain.html">probability_contain()</a></code>. This plot is reproduced from
Lloyd-Smith et al. (2005) figure 3C.
</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-kucharskiEarlyDynamicsTransmission2020" class="csl-entry">
Kucharski, Adam J, Timothy W Russell, Charlie Diamond, Yang Liu, John
Edmunds, Sebastian Funk, Rosalind M Eggo, et al. 2020. <span>“Early
Dynamics of Transmission and Control of COVID-19: A Mathematical
Modelling Study.”</span> <em>The Lancet Infectious Diseases</em> 20 (5):
553–58. <a href="https://doi.org/10.1016/S1473-3099(20)30144-4" class="external-link">https://doi.org/10.1016/S1473-3099(20)30144-4</a>.
</div>
<div id="ref-lloyd-smithSuperspreadingEffectIndividual2005" class="csl-entry">
Lloyd-Smith, J. O., S. J. Schreiber, P. E. Kopp, and W. M. Getz. 2005.
<span>“Superspreading and the Effect of Individual Variation on Disease
Emergence.”</span> <em>Nature</em> 438 (7066): 355–59. <a href="https://doi.org/10.1038/nature04153" class="external-link">https://doi.org/10.1038/nature04153</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Dillon C. Adam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
