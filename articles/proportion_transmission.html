<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Methods for calculating the proportion of transmission • superspreading</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Methods for calculating the proportion of transmission">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/superspreading.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6></li>
    <li><a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Proportion transmission</h6></li>
    <li><a class="dropdown-item" href="../articles/proportion_transmission.html">Methods for calculating the proportion of transmission</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Methods for calculating the proportion of transmission</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/v0.3.0/vignettes/proportion_transmission.Rmd" class="external-link"><code>vignettes/proportion_transmission.Rmd</code></a></small>
      <div class="d-none name"><code>proportion_transmission.Rmd</code></div>
    </div>

    
    
<p>This vignette explores the <code><a href="../reference/proportion_transmission.html">proportion_transmission()</a></code>
function in {superspreading}. The function calculates what proportion of
cases we would expect to cause a certain proportion of transmission for
a particular infectious disease (e.g. “how much transmission comes from
the top 10% of infectious individuals?”)</p>
<p>To perform this calculation, we assume that the offspring
distribution of disease transmission depends both on the distribution of
individual variability in transmissibility, which we define using a
Gamma distribution with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
as well as stochastic transmission within a population, which we define
using a Poisson process, following <span class="citation">Lloyd-Smith et
al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>.</p>
<p>If we put a Gamma distributed individual transmissibility into a
Poisson distribution, the result a negative binomial distribution. This
is defined by two parameters:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
the mean of the negative binomial distribution and the average number of
secondary cases caused by a typical primary case; and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
the dispersion parameter of the negative binomial distribution and
controls the heterogeneity in transmission. A smaller
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
results is more variability (overdispersion) in transmission and thus
superspreading events are more likely.</p>
<div class="alert alert-info">
<p>Poisson and geometric offspring distributions are special cases of
the negative binomial offspring distribution. By setting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
to <code>Inf</code> (or approximately infinite,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">&gt; 10^5</annotation></semantics></math>)
then the offspring distribution is a Poisson distribution. By setting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
to 1 the offspring distribution is a geometric distribution.</p>
<p>It is currently not possible to calculate the proportion transmission
using the Poisson-Lognormal and Poisson-Weibull distributions (whose
density and cumulative distribution functions are included in the
{superspreading} package).</p>
</div>
<p>The proportion of transmission can be calculated using two methods,
both of which are included in the <code><a href="../reference/proportion_transmission.html">proportion_transmission()</a></code>
function and can be changed using the <code>method</code> argument. The
first method focuses on transmission as it occurs in reality, accounting
both for variation in the mean number of secondary cases at the
individual <em>and</em> the stochastic nature of onwards transmission
within a population; the second method focuses only on variation in the
mean number of secondary cases at the individual level. The first method
is denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
and the second
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>.
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
method is the default (<code>method = "p_80"</code>).</p>
<div class="alert alert-danger">
<p>The output of <code>method = "p_80"</code> and
<code>method = "t_20"</code> have different interpretations and cannot
be used interchangeably without understanding the differences in what
they are measuring.</p>
<p>The output of <code>method = "p_80"</code> gives the proportion of
cases that generate a certain proportion of realised transmission. The
most common use case is calculating what proportion of cases would cause
80% of transmission during an outbreak of the infection. Thus a small
proportion in the output <code>&lt;data.frame&gt;</code> means that
there is a lot of overdispersion in individual-level transmission. The
<code>percent_transmission</code> argument when
<code>method = "p_80"</code> is to set the proportion of
transmission.</p>
<p>The output of <code>method = "t_20"</code> gives the proportion of
cases that we would expected to produced by a certain proportion of the
most infectious individuals. This is commonly used to calculate what
proportion of cases are expected to be caused by the most infectious 20%
of individuals. A high proportion in the output
<code>&lt;data.frame&gt;</code> means that there is a lot of
overdispersion in the transmission. The
<code>percent_transmission</code> argument when
<code>method = "t_20"</code> is to set the proportion of most infectious
cases to calculate their proportion of total transmission.</p>
<p>The key difference is that in a realised large outbreak (i.e. one
that includes stochastic transmission), it is highly likely that some
individuals will generate no secondary cases. This is because even a
non-zero expected number of secondary cases can produce a zero when
drawn from a Poisson process.</p>
</div>
<div class="section level2">
<h2 id="definitions">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h2>
<p>The formula for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
method as stated in <span class="citation">Endo et al. (<a href="#ref-endoEstimatingOverdispersionCOVID192020">2020</a>)</span>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>80</mn></msub><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>X</mi></msubsup><mtext mathvariant="normal">NB</mtext><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo><mo>;</mo><mi>k</mi><mo>,</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>k</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>k</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">
1 - p_{80} = \int^{X}_{0} \text{NB} ( \lfloor x \rfloor; k, \left( \frac{k}{(R_0) + k} \right) dx
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
satisfies</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mn>0.8</mn><mo>=</mo><mfrac><mn>1</mn><msub><mi>R</mi><mn>0</mn></msub></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>X</mi></msubsup><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo><mtext mathvariant="normal">NB</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo><mo>;</mo><mi>k</mi><mo>,</mo><mfrac><mi>k</mi><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>+</mo><mi>k</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">
1 - 0.8 = \frac{1}{R_0} \int^{X}_{0} \lfloor x \rfloor \text{NB} \left( \lfloor x \rfloor; k, \frac{k}{R_0 + k} \right) dx
</annotation></semantics></math> Additionally, <span class="citation">Endo et al. (<a href="#ref-endoEstimatingOverdispersionCOVID192020">2020</a>)</span>
showed that:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msub><mi>R</mi><mn>0</mn></msub></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>X</mi></msubsup><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo><mtext mathvariant="normal">NB</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo><mo>;</mo><mi>k</mi><mo>,</mo><mfrac><mi>k</mi><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>+</mo><mi>k</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>x</mi><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mrow><mi>X</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mtext mathvariant="normal">NB</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="false" form="prefix">⌊</mo><mi>x</mi><mo stretchy="false" form="postfix">⌋</mo><mo>;</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mfrac><mi>k</mi><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>+</mo><mi>k</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\frac{1}{R_0} \int^{X}_{0} \lfloor x \rfloor \text{NB} \left( \lfloor x \rfloor; k, \frac{k}{R_0 + k} \right) dx = \int^{X-1}_{0} \text{NB} \left( \lfloor x \rfloor; k + 1, \frac{k}{R_0 + k} \right)
</annotation></semantics></math></p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
method calculates, as stated by <span class="citation">Lloyd-Smith et
al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>:
“the expected proportion of transmission due to the most infectious 20%
of cases,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>”,
given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>20</mn></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>F</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>20</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">t_{20} = 1 - F_{trans}(x_{20})</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">F_{trans}</annotation></semantics></math>
is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msub><mi>R</mi><mn>0</mn></msub></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><mi>u</mi><msub><mi>f</mi><mi>v</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">
F_{trans}(x) = \frac{1}{R_0} \int^{x}_{0} u f_v (u) du
</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_\nu(x)</annotation></semantics></math>
is the probability density function (pdf) of the gamma distribution of
the individual reproduction number
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>.</p>
<p>For both methods the proportion of transmission can be modified using
the <code>percent_transmission</code> argument in
<code><a href="../reference/proportion_transmission.html">proportion_transmission()</a></code> so they are not fixed at 80 and
20, respectively, for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>.</p>
<p>There are two methods for calculating the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
method, analytically as given by <span class="citation">Endo et al. (<a href="#ref-endoEstimatingOverdispersionCOVID192020">2020</a>)</span>, or
numerically by sampling from a negative binomial distribution
(<code>proportion_transmission(..., simulate = TRUE)</code>. For the
purpose of this vignette to compare all of the methods we will term the
analytical calculation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>,
and the numerical calculation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>p</mi><mn>80</mn><mrow><mi>s</mi><mi>i</mi><mi>m</mi></mrow></msubsup><annotation encoding="application/x-tex">p_{80}^{sim}</annotation></semantics></math>.</p>
<p>Now that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
methods have been defined we’ll explore the functionality of each, their
characteristics and compare them, making note of any unexpected
behaviour to watch out for.</p>
<p>First we load the {superspreading}, {ggplot2}, {purrr} and {dplyr} R
packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploring-each-method">Exploring each method<a class="anchor" aria-label="anchor" href="#exploring-each-method"></a>
</h2>
<p>To show the proportion of transmission using both methods we can load
the estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
estimated from <span class="citation">Lloyd-Smith et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>,
which are stored in the library of epidemiological parameters in the
{epiparameter} R package, and the interoperability of {epiparameter} and
{superspreading} to directly supply the parameters for the offspring
distributions (<code>&lt;epiparameter&gt;</code> objects) to the
<code>offspring_dist</code> argument in
<code><a href="../reference/proportion_transmission.html">proportion_transmission()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/epiparameter/" class="external-link">epiparameter</a></span><span class="op">)</span></span>
<span><span class="va">offspring_dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://epiverse-trace.github.io/epiparameter/reference/epiparameter_db.html" class="external-link">epiparameter_db</a></span><span class="op">(</span></span>
<span>  epi_name <span class="op">=</span> <span class="st">"offspring distribution"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Returning 10 results that match the criteria (10 are parameterised). </span></span>
<span><span class="co">#&gt; Use subset to filter by entry variables or single_epiparameter to return a single entry. </span></span>
<span><span class="co">#&gt; To retrieve the citation for each use the 'get_citation' function</span></span></code></pre></div>
<p>Here we create a table with the estimates of the mean
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>)
and dispersion
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>)
for each disease from <span class="citation">Lloyd-Smith et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diseases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">offspring_dists</span>, <span class="va">`[[`</span>, FUN.VALUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"disease"</span><span class="op">)</span></span>
<span><span class="va">offspring_dists</span> <span class="op">&lt;-</span> <span class="va">offspring_dists</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">diseases</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">diseases</span> <span class="op">&lt;-</span> <span class="va">diseases</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">diseases</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">offspring_dist_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span></span>
<span>  <span class="va">offspring_dists</span>, <span class="va">get_parameters</span>, FUN.VALUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">offspring_dist_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="va">diseases</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">offspring_dist_params</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">offspring_dist_params</span></span>
<span><span class="co">#&gt;                         disease mean dispersion</span></span>
<span><span class="co">#&gt; 1                          SARS 1.63       0.16</span></span>
<span><span class="co">#&gt; 2                      Smallpox 3.19       0.37</span></span>
<span><span class="co">#&gt; 3                          Mpox 0.32       0.58</span></span>
<span><span class="co">#&gt; 4              Pneumonic Plague 1.32       1.37</span></span>
<span><span class="co">#&gt; 5 Hantavirus Pulmonary Syndrome 0.70       1.66</span></span>
<span><span class="co">#&gt; 6           Ebola Virus Disease 1.50       5.10</span></span></code></pre></div>
<p>Using these parameter estimates for the negative binomial offspring
distribution of each disease we can append the calculated proportion of
transmission caused by the most infectious 20% of cases, using the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
method, and the calculated proportion of transmission causing 80% of
onward transmission, using the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
method.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">offspring_dist_params</span><span class="op">$</span><span class="va">t20</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>  <span class="va">rbind</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>    <span class="va">offspring_dist_params</span>,</span>
<span>    MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>        R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, percent_transmission <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"t_20"</span>, format_prop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span><span class="va">offspring_dist_params</span><span class="op">$</span><span class="va">p80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span></span>
<span>  <span class="va">rbind</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>    <span class="va">offspring_dist_params</span>,</span>
<span>    MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>        R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>        method <span class="op">=</span> <span class="st">"p_80"</span>, format_prop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">offspring_dist_params</span></span>
<span><span class="co">#&gt;                         disease mean dispersion       t20       p80</span></span>
<span><span class="co">#&gt; 1                          SARS 1.63       0.16 0.8825175 0.1300095</span></span>
<span><span class="co">#&gt; 2                      Smallpox 3.19       0.37 0.7125723 0.2405781</span></span>
<span><span class="co">#&gt; 3                          Mpox 0.32       0.58 0.6201376 0.1609538</span></span>
<span><span class="co">#&gt; 4              Pneumonic Plague 1.32       1.37 0.4737949 0.3392229</span></span>
<span><span class="co">#&gt; 5 Hantavirus Pulmonary Syndrome 0.70       1.66 0.4476538 0.3023708</span></span>
<span><span class="co">#&gt; 6           Ebola Virus Disease 1.50       5.10 0.3363023 0.4315065</span></span></code></pre></div>
<p>It can be seen in the table above that when an offspring distribution
has a smaller dispersion
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>)
parameter the proportion of cases produced by the most infectious 20% of
cases is high, and the proportion of cases that produce 80% of
transmission is low. The estimates for SARS demonstrate this point. Both
metrics lead to the same conclusion that disease transmission dynamics
for the 2003 SARS outbreak in Singapore are heterogeneous and
superspreading is a important aspect of the outbreak.</p>
<p>The variability in individual-level transmission comes from modelling
the individual reproduction number,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
as a gamma distribution, instead of assuming that the individual-level
reproduction number is equal for all individuals, which would result in
a Poisson offspring distribution (see <span class="citation">Lloyd-Smith
et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>
<a href="https://static-content.springer.com/esm/art%3A10.1038%2Fnature04153/MediaObjects/41586_2005_BFnature04153_MOESM1_ESM.pdf" class="external-link">Supplementary
Material</a> for more information). To visualise the inherent
variability resulting from the gamma-distributed reproduction number and
how that compares to the assumption of a homogeneous population we can
plot the expected proportion of transmission against the proportion of
infectious cases.</p>
<p>For this we will need to write a couple of custom functions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># nolint start for `:::`</span></span>
<span><span class="va">get_infectious_curve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">R</span>, <span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># upper limit of x when y = 0</span></span>
<span>  <span class="va">upper_u</span> <span class="op">&lt;-</span> <span class="fu">superspreading</span><span class="fu">:::</span><span class="fu">solve_for_u</span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">0</span>, R <span class="op">=</span> <span class="va">R</span>, k <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">upper_u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">upper_u</span><span class="op">)</span></span>
<span>  <span class="va">u_seq</span> <span class="op">&lt;-</span> <span class="fu">superspreading</span><span class="fu">:::</span><span class="fu"><a href="../reference/lseq.html">lseq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1e-5</span>, to <span class="op">=</span> <span class="va">upper_u</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">u_seq</span>, <span class="kw">function</span><span class="op">(</span><span class="va">upper</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span></span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="va">u</span> <span class="op">*</span> <span class="fu">superspreading</span><span class="fu">:::</span><span class="fu"><a href="../reference/gamma.html">fvx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">u</span>, <span class="va">R</span>, <span class="va">k</span><span class="op">)</span>,</span>
<span>      lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="va">upper</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">value</span> <span class="op">/</span> <span class="va">R</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">expected_v_more_than_x</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>  <span class="va">proportion_more_than_x</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu">superspreading</span><span class="fu">:::</span><span class="fu"><a href="../reference/gamma.html">pgammaRk</a></span><span class="op">(</span><span class="va">u_seq</span>, R <span class="op">=</span> <span class="va">R</span>, k <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    exp_t <span class="op">=</span> <span class="va">expected_v_more_than_x</span>,</span>
<span>    prop_i <span class="op">=</span> <span class="va">proportion_more_than_x</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># nolint end</span></span></code></pre></div>
<p>We can now reproduce Figure 1b in <span class="citation">Lloyd-Smith
et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>
using the offspring distribution parameters obtained above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infect_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">offspring_dist_params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">disease</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">get_infectious_curve</span><span class="op">(</span>R <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">mean</span>, k <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">dispersion</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>            disease <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">disease</span>,</span>
<span>            R <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">mean</span>, k <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">dispersion</span></span>
<span>          <span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">infect_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">infect_curve</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">infect_curve</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_i</span>, y <span class="op">=</span> <span class="va">exp_t</span>, colour <span class="op">=</span> <span class="va">disease</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.2</span>, linetype <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    aspect.ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>    angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    vjust <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    label <span class="op">=</span> <span class="st">"Homogeneous population"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Proportion of infectious cases (ranked)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Expected proportion of transmission"</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="proportion_transmission_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>This plot shows the variability in transmission owing to the
gamma-distributed individual reproduction number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>).
If we take a slice through the above plot when the proportion of
infectious cases equals 0.2 (shown by the dashed line) we can calculate
the proportion of transmission caused by the most infectious 20% of
cases using the
<code>proportion_tranmission(..., method = "t_20")</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k_seq</span> <span class="op">&lt;-</span> <span class="fu">superspreading</span><span class="fu">:::</span><span class="fu"><a href="../reference/lseq.html">lseq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.01</span>, to <span class="op">=</span> <span class="fl">100</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="co"># nolint</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span></span>
<span>  <span class="va">k_seq</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>      R <span class="op">=</span> <span class="fl">2</span>, k <span class="op">=</span> <span class="va">x</span>, percent_transmission <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>      method <span class="op">=</span> <span class="st">"t_20"</span>, format_prop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">prop_t20</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">k_seq</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prop_t20</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k_seq</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">offspring_dist_params</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">dispersion</span>,</span>
<span>      y <span class="op">=</span> <span class="va">t20</span>,</span>
<span>      fill <span class="op">=</span> <span class="va">disease</span></span>
<span>    <span class="op">)</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    aspect.ratio <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>      <span class="st">"Proportion of transmission expected from"</span>,</span>
<span>      <span class="st">"the most infectious 20% of cases"</span>,</span>
<span>      sep <span class="op">=</span> <span class="st">" \n"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Dispersion parameter"</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="proportion_transmission_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>The above plot replicates Figure 1c from <span class="citation">Lloyd-Smith et al. (<a href="#ref-lloyd-smithSuperspreadingEffectIndividual2005">2005</a>)</span>.
It shows how different diseases have different proportion of
transmission from the most infectious 20% owing to varying degrees of
overdispersion
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>).</p>
<p>The plot uses an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
of 2, however, one characteristic of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
method is that different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
do not influence the proportion of transmission, so the plot would look
identical with other value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>.
This is because as shown the equation defining the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
method above the integral is divided by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
so that only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_{\nu}(u)</annotation></semantics></math>
control the proportion of transmission.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For k = 0.5</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">0.1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     R   k prop_80</span></span>
<span><span class="co">#&gt; 1 0.1 0.5   99.6%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_80</span></span>
<span><span class="co">#&gt; 1 1 0.5   99.6%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">5</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_80</span></span>
<span><span class="co">#&gt; 1 5 0.5   99.6%</span></span>
<span></span>
<span><span class="co"># For k = 2</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">0.1</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     R k prop_80</span></span>
<span><span class="co">#&gt; 1 0.1 2   94.9%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R k prop_80</span></span>
<span><span class="co">#&gt; 1 1 2   94.9%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">5</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R k prop_80</span></span>
<span><span class="co">#&gt; 1 5 2   94.9%</span></span></code></pre></div>
<p>This is not the case for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>,
where changes in both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
influence the proportion of transmission.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For k = 0.5</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">0.1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     R   k prop_80</span></span>
<span><span class="co">#&gt; 1 0.1 0.5   6.71%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_80</span></span>
<span><span class="co">#&gt; 1 1 0.5   22.6%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">5</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_80</span></span>
<span><span class="co">#&gt; 1 5 0.5   29.3%</span></span>
<span></span>
<span><span class="co"># For k = 2</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">0.1</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     R k prop_80</span></span>
<span><span class="co">#&gt; 1 0.1 2    7.3%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R k prop_80</span></span>
<span><span class="co">#&gt; 1 1 2   35.6%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">5</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R k prop_80</span></span>
<span><span class="co">#&gt; 1 5 2   48.9%</span></span></code></pre></div>
<p>One thing that was mentioned above is that the interpretation of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
methods are not interchangeable, additionally,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>80</mn></msub><annotation encoding="application/x-tex">t_{80}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>20</mn></msub><annotation encoding="application/x-tex">p_{20}</annotation></semantics></math>
are not equal. Stated differently, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
method to calculate the proportion of transmission that cause 20% of
cases, and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
method to calculate the proportion of transmission caused by the most
infectious 80% are not equivalent. It is also the case that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>80</mn></msub><mo>≠</mo><msub><mi>t</mi><mn>20</mn></msub></mrow><annotation encoding="application/x-tex">1 - p_{80} \neq t_{20}</annotation></semantics></math>,
thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>t</mi><mn>20</mn></msub><mo>≠</mo><msub><mi>p</mi><mn>80</mn></msub></mrow><annotation encoding="application/x-tex">1 - t_{20} \neq p_{80}</annotation></semantics></math>.</p>
<p>Here we vary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and show that by setting the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
method to <code>percent_transmission = 0.2</code>, and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
method to <code>percent_transmission = 0.8</code> the two cannot be
interchangeably interpreted as outlined in the box above.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R = 1, k = 0.5</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_20</span></span>
<span><span class="co">#&gt; 1 1 0.5   2.45%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_80</span></span>
<span><span class="co">#&gt; 1 1 0.5   99.6%</span></span>
<span></span>
<span><span class="co"># R = 3, k = 2</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">3</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R k prop_20</span></span>
<span><span class="co">#&gt; 1 3 2   5.86%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">3</span>, k <span class="op">=</span> <span class="fl">2</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R k prop_80</span></span>
<span><span class="co">#&gt; 1 3 2   94.9%</span></span></code></pre></div>
<p>Here we show that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mn>80</mn></msub><mo>≠</mo><msub><mi>t</mi><mn>20</mn></msub></mrow><annotation encoding="application/x-tex">1 - p_{80} \neq t_{20}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>t</mi><mn>20</mn></msub><mo>≠</mo><msub><mi>p</mi><mn>80</mn></msub></mrow><annotation encoding="application/x-tex">1 - t_{20} \neq p_{80}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span>,</span>
<span>  format_prop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.7735753</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_20</span></span>
<span><span class="co">#&gt; 1 1 0.5     65%</span></span>
<span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">"t_20"</span>,</span>
<span>  format_prop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.3501798</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0.5</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   R   k prop_80</span></span>
<span><span class="co">#&gt; 1 1 0.5   22.6%</span></span></code></pre></div>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>20</mn></msub><annotation encoding="application/x-tex">t_{20}</annotation></semantics></math>
method allows for true homogeneity when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>→</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">k \rightarrow \infty</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>20</mn></msub><mo>=</mo><mn>20</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">t_{20} = 20\%</annotation></semantics></math>),
whereas the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>80</mn></msub><annotation encoding="application/x-tex">p_{80}</annotation></semantics></math>
method does not allow for true homogeneity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>80</mn></msub><mo>≠</mo><mn>80</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">p_{80} \neq 80\%</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="cn">Inf</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"p_80"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Infinite values of k are being approximated by 1e+05 for calculations.</span></span>
<span><span class="co">#&gt;   R     k prop_80</span></span>
<span><span class="co">#&gt; 1 1 1e+05   43.2%</span></span>
<span><span class="fu"><a href="../reference/proportion_transmission.html">proportion_transmission</a></span><span class="op">(</span></span>
<span>  R <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="cn">Inf</span>, percent_transmission <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"t_20"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Infinite values of k are being approximated by 1e+05 for calculations.</span></span>
<span><span class="co">#&gt;   R     k prop_80</span></span>
<span><span class="co">#&gt; 1 1 1e+05   80.1%</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-endoEstimatingOverdispersionCOVID192020" class="csl-entry">
Endo, Akira, Centre for the Mathematical Modelling of Infectious
Diseases COVID-19 Working Group, Sam Abbott, Adam J. Kucharski, and
Sebastian Funk. 2020. <span>“Estimating the Overdispersion in COVID-19
Transmission Using Outbreak Sizes Outside China.”</span> <em>Wellcome
Open Research</em> 5 (July): 67. <a href="https://doi.org/10.12688/wellcomeopenres.15842.3" class="external-link">https://doi.org/10.12688/wellcomeopenres.15842.3</a>.
</div>
<div id="ref-lloyd-smithSuperspreadingEffectIndividual2005" class="csl-entry">
Lloyd-Smith, J. O., S. J. Schreiber, P. E. Kopp, and W. M. Getz. 2005.
<span>“Superspreading and the Effect of Individual Variation on Disease
Emergence.”</span> <em>Nature</em> 438 (7066): 355–59. <a href="https://doi.org/10.1038/nature04153" class="external-link">https://doi.org/10.1038/nature04153</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Dillon C. Adam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
