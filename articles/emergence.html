<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Pathogen evolution in the emergence of infectious disease outbreaks • superspreading</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pathogen evolution in the emergence of infectious disease outbreaks">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">superspreading</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/superspreading.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Parameter estimation</h6></li>
    <li><a class="dropdown-item" href="../articles/estimate_individual_level_transmission.html">Estimate individual-level transmission</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_network_outbreaks.html">Outbreaks in heterogeneous networks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Superspreading for decision-making</h6></li>
    <li><a class="dropdown-item" href="../articles/epidemic_risk.html">Epidemic Risk</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Proportion transmission</h6></li>
    <li><a class="dropdown-item" href="../articles/proportion_transmission.html">Methods for calculating the proportion of transmission</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Pathogen evolution and emergence</h6></li>
    <li><a class="dropdown-item" href="../articles/emergence.html">Pathogen evolution in the emergence of infectious disease outbreaks</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/design-principles.html">Design Principles for {superspreading}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/superspreading/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Pathogen evolution in the emergence of infectious disease outbreaks</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/superspreading/blob/main/vignettes/emergence.Rmd" class="external-link"><code>vignettes/emergence.Rmd</code></a></small>
      <div class="d-none name"><code>emergence.Rmd</code></div>
    </div>

    
    
<p>Infectious diseases that cannot transmit effectively between humans
cannot cause sustained disease outbreaks. However, they can cause
stuttering chains of transmission with several cases. These short
human-to-human transmission chains provide opportunities for the
pathogen to adapt to humans and enhance transmission potential.
Therefore, even in cases where a pathogen initially introduced into a
human population might have a reproduction number below 1, that is on
average it is transmitted to less than one other person (bound to
inevitably going extinct without pathogen evolution), if a pathogen
mutates while infecting humans, its reproduction number might evolve to
exceed 1, and emerge to cause sustained outbreaks.</p>
<p>This vignette explores the <code><a href="../reference/probability_emergence.html">probability_emergence()</a></code>
function. This is based on the framework of <span class="citation">Antia
et al. (<a href="#ref-antiaRoleEvolutionEmergence2003">2003</a>)</span>
which uses a multi-type branching process to calculate the probability
that a subcritical zoonotic spillover will evolve into a more
transmissible pathogen with a reproduction number greater than 1 and
thus be able to cause a sustained epidemic from human-to-human
transmission.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<p>We use <code><a href="../reference/probability_emergence.html">probability_emergence()</a></code> to replicate Figure 2b
from <span class="citation">Antia et al. (<a href="#ref-antiaRoleEvolutionEmergence2003">2003</a>)</span> showing how
the probability of emergence changes for different wild-type
reproduction numbers and different mutation rates. This assumes a 2-type
branching process with a wild-type pathogen with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R_0 &lt; 1</annotation></semantics></math>
and a mutant pathogen with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R_0 &gt; 1</annotation></semantics></math>,
we test with mutant reproduction numbers of 1.2, 1.5, 1,000.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R_wild</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">R_mutant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">mutation_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  R_wild <span class="op">=</span> <span class="va">R_wild</span>,</span>
<span>  R_mutant <span class="op">=</span> <span class="va">R_mutant</span>,</span>
<span>  mutation_rate <span class="op">=</span> <span class="va">mutation_rate</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prob_emerge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>  <span class="va">params</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/probability_emergence.html">probability_emergence</a></span><span class="op">(</span></span>
<span>      R_wild <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R_wild"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      R_mutant <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R_mutant"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      mutation_rate <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"mutation_rate"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      num_init_infect <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">params</span>, prob_emerge <span class="op">=</span> <span class="va">prob_emerge</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">R_wild</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_emerge</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mutation_rate</span><span class="op">)</span>,</span>
<span>      linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">R_mutant</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of emergence"</span>,</span>
<span>    transform <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">log_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Mutation rate"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#228B22"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Mutant pathogen R0"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dotted"</span>, <span class="st">"dashed"</span>, <span class="st">"solid"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span> <span class="op">~</span> <span class="va">of</span> <span class="op">~</span> <span class="va">introduced</span> <span class="op">~</span> <span class="va">pathogen</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>    n.breaks <span class="op">=</span> <span class="fl">7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in scale_y_continuous(name = "Probability of emergence", transform =</span></span>
<span><span class="co">#&gt; "log", : <span style="color: #00BB00;">log-2.718282</span> transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="emergence_files/figure-html/plot-prob-emerge-1.png" alt="Line plot showing the probability of emergence of a pathogen as a function of the basic reproduction number (R0) of the introduced pathogen. The x-axis represents the R0 of the introduced pathogen, ranging from 0 to 1.2. The y-axis shows the probability of emergence on a logarithmic scale from 1e-05 to 1. Lines vary by mutation rate (green for 0.001 and black for 0.1) and by mutant pathogen R0 (dotted for R0 = 1.2, dashed for R0 = 1.5, solid for R0 = 1000). For both mutation rates, the probability of emergence increases with the R0 of the introduced pathogen and with the R0 of the mutant. Higher mutation rates and higher mutant R0s lead to higher probabilities of emergence." width="768"></p>
<p>Next we’ll replicate Figure 3a from <span class="citation">Antia et
al. (<a href="#ref-antiaRoleEvolutionEmergence2003">2003</a>)</span>.
This uses an extension of the 2-type (or one-step) branching process
model to include multiple intermediate mutants/variants between the
introduced wild-type and the fully-evolved pathogen with an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R &gt; 1</annotation></semantics></math>.
In <span class="citation">Antia et al. (<a href="#ref-antiaRoleEvolutionEmergence2003">2003</a>)</span> this is
called the <em>jackpot model</em>. The introduced pathogen is
subcritical
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R &lt; 1</annotation></semantics></math>),
and the intermediate variants have the same reproduction number as the
wild-type. Only the final fully-evolved variant is supercritical
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R &gt; 1</annotation></semantics></math>).</p>
<p>We use the same number of intermediate mutants between the wild-type
and the fully-evolved strain as <span class="citation">Antia et al. (<a href="#ref-antiaRoleEvolutionEmergence2003">2003</a>)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R_wild</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">R_mutant</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">mutation_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">num_mutants</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  R_wild <span class="op">=</span> <span class="va">R_wild</span>,</span>
<span>  R_mutant <span class="op">=</span> <span class="va">R_mutant</span>,</span>
<span>  mutation_rate <span class="op">=</span> <span class="va">mutation_rate</span>,</span>
<span>  num_mutants <span class="op">=</span> <span class="va">num_mutants</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prob_emerge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>  <span class="va">params</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/probability_emergence.html">probability_emergence</a></span><span class="op">(</span></span>
<span>      R_wild <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R_wild"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      R_mutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"R_wild"</span><span class="op">]</span><span class="op">]</span>, <span class="va">x</span><span class="op">[[</span><span class="st">"num_mutants"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">x</span><span class="op">[[</span><span class="st">"R_mutant"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      mutation_rate <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"mutation_rate"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      num_init_infect <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">params</span>, prob_emerge <span class="op">=</span> <span class="va">prob_emerge</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">R_wild</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_emerge</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">num_mutants</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of emergence"</span>,</span>
<span>    transform <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">log_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Number of \nintermediate mutants"</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span> <span class="op">~</span> <span class="va">of</span> <span class="op">~</span> <span class="va">introduced</span> <span class="op">~</span> <span class="va">pathogen</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>    n.breaks <span class="op">=</span> <span class="fl">7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in scale_y_continuous(name = "Probability of emergence", transform =</span></span>
<span><span class="co">#&gt; "log", : <span style="color: #00BB00;">log-2.718282</span> transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="emergence_files/figure-html/plot-prob-emerge-multi-type-1.png" alt="Line plot showing the probability of emergence of a pathogen as a function of the basic reproduction number (R0) of the introduced pathogen, with varying numbers of intermediate mutants before reaching the fully-evolved mutant. The x-axis represents the R0 of the introduced pathogen (ranging from 0 to 1.2), and the y-axis shows the probability of emergence on a logarithmic scale from 1e-05 to 1. Lines represent different numbers of intermediate mutants: red for 0, blue for 1, green for 2, purple for 3, and orange for 4. As the number of required intermediate mutants increases, the probability of emergence decreases across all R0 values. All curves rise with increasing R0, and converge at higher R0 values near 1.2." width="768"></p>
<p>Thus far we’ve only introduced a single infection, however, just as
with <code><a href="../reference/probability_epidemic.html">probability_epidemic()</a></code> and
<code><a href="../reference/probability_extinct.html">probability_extinct()</a></code>, we extend the method of <span class="citation">Antia et al. (<a href="#ref-antiaRoleEvolutionEmergence2003">2003</a>)</span> and
introduce multiple initial human infections using the
<code>num_init_infect</code> argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R_wild</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">R_mutant</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">mutation_rate</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">num_mutants</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">num_init_infect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  R_wild <span class="op">=</span> <span class="va">R_wild</span>,</span>
<span>  R_mutant <span class="op">=</span> <span class="va">R_mutant</span>,</span>
<span>  mutation_rate <span class="op">=</span> <span class="va">mutation_rate</span>,</span>
<span>  num_mutants <span class="op">=</span> <span class="va">num_mutants</span>,</span>
<span>  num_init_infect <span class="op">=</span> <span class="va">num_init_infect</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prob_emerge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>  <span class="va">params</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/probability_emergence.html">probability_emergence</a></span><span class="op">(</span></span>
<span>      R_wild <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"R_wild"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      R_mutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"R_wild"</span><span class="op">]</span><span class="op">]</span>, <span class="va">x</span><span class="op">[[</span><span class="st">"num_mutants"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">x</span><span class="op">[[</span><span class="st">"R_mutant"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      mutation_rate <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"mutation_rate"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      num_init_infect <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="st">"num_init_infect"</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">params</span>, prob_emerge <span class="op">=</span> <span class="va">prob_emerge</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">R_wild</span>,</span>
<span>      y <span class="op">=</span> <span class="va">prob_emerge</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">num_init_infect</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Probability of emergence"</span>,</span>
<span>    transform <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_log.html" class="external-link">log_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Number of introductions"</span>,</span>
<span>    palette <span class="op">=</span> <span class="st">"Set1"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span> <span class="op">~</span> <span class="va">of</span> <span class="op">~</span> <span class="va">introduced</span> <span class="op">~</span> <span class="va">pathogen</span><span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>    n.breaks <span class="op">=</span> <span class="fl">7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in scale_y_continuous(name = "Probability of emergence", transform =</span></span>
<span><span class="co">#&gt; "log", : <span style="color: #00BB00;">log-2.718282</span> transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="emergence_files/figure-html/plot-prob-emerge-multi-init-infect-1.png" alt="Line graph showing the relationship between the basic reproduction number (R0) of an introduced pathogen and the probability of emergence, under varying numbers of introductions. The x-axis represents R0 values from 0 to 1.2, and the y-axis (logarithmic scale) represents the probability of emergence, from 1e-05 to 1. Five curves are shown for different numbers of introductions: 1 (red), 3 (blue), 5 (green), 7 (purple), and 9 (orange). All curves show increasing probability of emergence with higher R0, and higher numbers of introductions consistently increase emergence probability. Increasing the number of initial infections has diminishing increases on the probability of emergence with greater number of introductions." width="768"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-antiaRoleEvolutionEmergence2003" class="csl-entry">
Antia, Rustom, Roland R. Regoes, Jacob C. Koella, and Carl T. Bergstrom.
2003. <span>“The Role of Evolution in the Emergence of Infectious
Diseases.”</span> <em>Nature</em> 426 (6967): 658–61. <a href="https://doi.org/10.1038/nature02104" class="external-link">https://doi.org/10.1038/nature02104</a>.
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Adam Kucharski, Dillon C. Adam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
